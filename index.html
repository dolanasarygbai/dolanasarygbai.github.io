<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Генеалогическое древо · 6 поколений</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #0a0c12;
            color: #eef3fc;
            line-height: 1.4;
            height: 100vh;
            overflow: hidden;
        }

        .main-content {
            display: flex;
            height: 100vh;
            position: relative;
        }

        .tree-wrapper {
            flex: 3;
            background: #0f1419;
            overflow: auto;
            position: relative;
            background: radial-gradient(circle at 30% 30%, #17212b, #030405);
        }

        .info-sidebar {
            flex: 1;
            min-width: 340px;
            max-width: 400px;
            background: #121a24;
            border-left: 2px solid #3b5e8b;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-shadow: -5px 0 25px rgba(0,0,0,0.7);
            transition: transform 0.3s ease;
            z-index: 1000;
            position: relative;
        }

        .info-sidebar.hidden {
            transform: translateX(100%);
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
        }

        .section-title {
            color: #ffd966;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3b5e8b;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ДЕРЕВО */
        .tree {
            display: flex;
            flex-direction: column;
            min-width: 2800px;
            min-height: 2200px;
            padding: 80px 100px;
            position: relative;
        }

        .generation {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            margin-bottom: 150px; /* Увеличено расстояние между поколениями */
            width: 100%;
        }

        .gen-row {
            display: flex;
            flex-wrap: nowrap;
            gap: 60px; /* Увеличено расстояние между карточками */
            justify-content: center;
            position: relative;
        }

        .person-card {
            min-width: 200px;
            max-width: 230px;
            background: #1e2a36;
            border-radius: 20px;
            padding: 15px 12px;
            border: 2px solid;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            z-index: 50;
            backdrop-filter: blur(2px);
            color: #f0f5ff;
        }

        .person-card.paternal-line {
            border-color: #3b82f6;
            box-shadow: 0 0 15px #3b82f6;
        }

        .person-card.maternal-line {
            border-color: #c77dff;
            box-shadow: 0 0 15px #c77dff;
        }

        .person-card.main-person {
            border-color: #ffd966;
            border-width: 4px;
            box-shadow: 0 0 30px gold;
            transform: scale(1.02);
        }

        .person-card.dimmed {
            opacity: 0.3;
            filter: grayscale(0.7);
            transition: 0.3s;
        }

        .person-card.highlighted {
            opacity: 1 !important;
            filter: none !important;
            transform: scale(1.05);
            z-index: 100;
        }

        .person-card:hover {
            transform: scale(1.03);
            box-shadow: 0 0 25px cyan;
        }

        .person-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: white;
            margin-bottom: 5px;
        }

        .person-years {
            font-size: 0.85rem;
            color: #b0c6da;
            margin-bottom: 5px;
        }

        .person-relation {
            font-size: 0.75rem;
            background: #2f3b4b;
            padding: 4px 8px;
            border-radius: 20px;
            display: inline-block;
            color: #ddd;
        }

        /* SVG ЛИНИЙ */
        .connector-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        .connector-svg path {
            stroke-width: 3px;
            fill: none;
            stroke-linecap: round;
            transition: all 0.3s;
        }

        .paternal-path {
            stroke: #3b82f6;
            stroke-opacity: 0.6;
        }

        .maternal-path {
            stroke: #c77dff;
            stroke-opacity: 0.6;
        }

        .highlighted-path {
            stroke: #ffd966 !important;
            filter: drop-shadow(0 0 12px gold);
            stroke-width: 5px !important;
            stroke-opacity: 1 !important;
        }

        /* ПАНЕЛЬ */
        .selected-info {
            background: #1f2a36;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #ffd966;
            margin-bottom: 20px;
        }

        .selected-name {
            font-size: 1.3rem;
            color: #ffd966;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .info-details {
            font-size: 0.9rem;
        }

        .info-row {
            margin-bottom: 8px;
            display: flex;
            border-bottom: 1px solid #2f3b4b;
            padding-bottom: 5px;
        }

        .info-label {
            font-weight: bold;
            min-width: 100px;
            color: #b3caf5;
        }

        .siblings-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .sibling {
            padding: 6px 12px;
            background: #2a3645;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            border: 1px solid #4d6278;
            transition: 0.2s;
        }

        .sibling:hover {
            background: #3b4b60;
            border-color: #ffd966;
        }

        .sibling.active {
            background: #ffd966;
            color: #1a1a2e;
            font-weight: bold;
            border-color: #fff;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
        }

        .paternal-box {
            width: 16px;
            height: 16px;
            background: #3b82f6;
            border-radius: 4px;
        }

        .maternal-box {
            width: 16px;
            height: 16px;
            background: #c77dff;
            border-radius: 4px;
        }

        .notes {
            background: #1a2633;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #d4a373;
            font-size: 0.85rem;
            margin-top: 15px;
        }

        .important-note {
            background: #1f2e3f;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #4a7bac;
            font-size: 0.85rem;
            margin-top: 10px;
        }

        .current-selection {
            background: #1a2532;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .zoom-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 8px;
        }

        .zoom-btn {
            background: #2a3b4c;
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            border: 1px solid #5f7f9f;
        }

        .toggle-panel-btn {
            background: #ffd966;
            color: #1a1a2e;
            border: none;
            padding: 8px 15px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .photo-thumb {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 2px solid #3b5e8b;
            background: #1f2a36;
        }
    </style>
</head>
<body>
    <div class="main-content">
        <div class="tree-wrapper" id="treeWrapper">
            <div class="tree" id="tree">
                <svg class="connector-svg" id="lineSvg"></svg>
                
                <!-- ПОКОЛЕНИЕ 1 (прадеды) -->
                <div class="generation" id="gen1">
                    <div class="gen-row" style="justify-content: space-between; width: 100%;">
                        <!-- сторона отца (синие) -->
                        <div style="display: flex; gap: 40px;">
                            <div class="person-card paternal-line" data-id="yaar" data-side="paternal">
                                <div class="person-name">Чооду Яар Сулепей</div>
                                <div class="person-years">~1860 г.</div>
                                <div class="person-relation">прадед (отца)</div>
                            </div>
                            <div class="person-card paternal-line" data-id="sevil" data-side="paternal">
                                <div class="person-name">Чооду Севил Балчыма</div>
                                <div class="person-years">~1865 г.</div>
                                <div class="person-relation">прабабушка (отца)</div>
                            </div>
                            <div class="person-card paternal-line" data-id="chambal" data-side="paternal">
                                <div class="person-name">Чооду Чигжит Чамбал</div>
                                <div class="person-years">~1865 г.</div>
                                <div class="person-relation">прадед (отца)</div>
                            </div>
                            <div class="person-card paternal-line" data-id="sagaan" data-side="paternal">
                                <div class="person-name">Чооду Седип Сагаан</div>
                                <div class="person-years">~1870 г.</div>
                                <div class="person-relation">прабабушка (отца)</div>
                            </div>
                        </div>
                        
                        <div style="color: #6d8eb0; padding: 0 20px;">⸻ разрыв ⸻</div>
                        
                        <!-- сторона матери (лиловые) -->
                        <div style="display: flex; gap: 40px;">
                            <div class="person-card maternal-line" data-id="dolzat" data-side="maternal">
                                <div class="person-name">Чооду Долзат Чамыян</div>
                                <div class="person-years">~1868 г.</div>
                                <div class="person-relation">прабабушка (матери)</div>
                            </div>
                            <div class="person-card maternal-line" data-id="danzyn" data-side="maternal">
                                <div class="person-name">Чооду Данзын Чигжит</div>
                                <div class="person-years">~1863 г.</div>
                                <div class="person-relation">прадед (матери)</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 2 (бабушки/дедушки) -->
                <div class="generation" id="gen2">
                    <div class="gen-row">
                        <div class="person-card paternal-line" data-id="dozum">
                            <div class="person-name">Допуу Дозум</div>
                            <div class="person-years">3.08.1894 г.</div>
                            <div class="person-relation">бабушка по отцу</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sirzhim">
                            <div class="person-name">Долгар Сиржим</div>
                            <div class="person-years">10.05.1899 г.</div>
                            <div class="person-relation">сестра матери отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="monke">
                            <div class="person-name">Начын Мөңке</div>
                            <div class="person-years">18.09.1890 г.</div>
                            <div class="person-relation">дедушка по отцу</div>
                        </div>
                        <div class="person-card maternal-line" data-id="demchik">
                            <div class="person-name">Чооду Демчиккей</div>
                            <div class="person-years">15.09.1889 г.</div>
                            <div class="person-relation">дедушка по матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="azhyk">
                            <div class="person-name">Чооду Ажыккай</div>
                            <div class="person-years">~1888 г.</div>
                            <div class="person-relation">бабушка по матери</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 3 (родители, братья, сестры) -->
                <div class="generation" id="gen3">
                    <div class="gen-row" style="gap: 40px;">
                        <!-- сторона отца -->
                        <div class="person-card paternal-line" data-id="manchalmaa">
                            <div class="person-name">Манчалмаа</div>
                            <div class="person-years">10.09.1918 г.</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sandan">
                            <div class="person-name">Санчат Сандан</div>
                            <div class="person-years">1.08.1920 г.</div>
                            <div class="person-relation">отец</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sandal">
                            <div class="person-name">Саңдал</div>
                            <div class="person-years">15.02.1924 г.</div>
                            <div class="person-relation">брат отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sanmaa">
                            <div class="person-name">Саңмаа</div>
                            <div class="person-years">31.08.1931 г.</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        
                        <!-- сторона матери (братья и сестры) -->
                        <div class="person-card maternal-line" data-id="saadak">
                            <div class="person-name">Саадак Астыр</div>
                            <div class="person-years">05.07.1904 г.</div>
                            <div class="person-relation">ст. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="ayyyr">
                            <div class="person-name">Айыыр Дүшбүн</div>
                            <div class="person-years">01.09.1909 г.</div>
                            <div class="person-relation">ст. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="dapyy">
                            <div class="person-name">Дапый-оол Н.</div>
                            <div class="person-years">10.04.1915 г.</div>
                            <div class="person-relation">ст. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="dungmai">
                            <div class="person-name">Чооду Дуңмай</div>
                            <div class="person-years">15.03.1917 г.</div>
                            <div class="person-relation">ст. сестра матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="okashtay" id="mother">
                            <div class="person-name">Санчат Окаштай</div>
                            <div class="person-years">01.03.1920 г.</div>
                            <div class="person-relation">мать</div>
                        </div>
                        <div class="person-card maternal-line" data-id="diimaa">
                            <div class="person-name">Диимаа</div>
                            <div class="person-years">08.03.1922 г.</div>
                            <div class="person-relation">мл. сестра матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="khuurak">
                            <div class="person-name">Хуурак-оол</div>
                            <div class="person-years">15.01.1923 г.</div>
                            <div class="person-relation">мл. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="chazhil">
                            <div class="person-name">Чажылмаа Е.</div>
                            <div class="person-years">03.07.1929 г.</div>
                            <div class="person-relation">мл. сестра матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="onermaa">
                            <div class="person-name">Онермаа</div>
                            <div class="person-years">01.01.1936 г.</div>
                            <div class="person-relation">мл. сестра матери</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 4 (я, братья/сестры, дети Манчалмаа и Саңмаа) -->
                <div class="generation" id="gen4">
                    <div class="gen-row" style="gap: 35px;">
                        <!-- Дети Манчалмаа -->
                        <div class="person-card paternal-line" data-id="monge">
                            <div class="person-name">Монгал Мөнге</div>
                            <div class="person-years">30.04.1937 г.</div>
                            <div class="person-relation">сын Манчалмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="elizaveta">
                            <div class="person-name">Монгал Елизавета</div>
                            <div class="person-years">30.04.1941 г.</div>
                            <div class="person-relation">дочь Манчалмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="diizenmaa">
                            <div class="person-name">Монгал Диизенмаа</div>
                            <div class="person-years">08.08.1944 г.</div>
                            <div class="person-relation">дочь Манчалмаа</div>
                        </div>
                        
                        <!-- Дети Саңмаа -->
                        <div class="person-card paternal-line" data-id="kechil_vlad">
                            <div class="person-name">Кечил-оол В.</div>
                            <div class="person-years">12.02.1952 г.</div>
                            <div class="person-relation">сын Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="bopuymaa">
                            <div class="person-name">Билчеймаа Б.</div>
                            <div class="person-years">18.06.1954 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="polum_natalya">
                            <div class="person-name">Полум Наталья</div>
                            <div class="person-years">02.03.1956 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="chechena">
                            <div class="person-name">Чагар-оол Ч.</div>
                            <div class="person-years">25.04.1960 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="fedor">
                            <div class="person-name">Билчеймаа Ф.</div>
                            <div class="person-years">28.01.1958 г.</div>
                            <div class="person-relation">сын Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="mikhail">
                            <div class="person-name">Билчеймаа М.</div>
                            <div class="person-years">01.12.1961 г.</div>
                            <div class="person-relation">сын Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="saida">
                            <div class="person-name">Сарыгбай Саида</div>
                            <div class="person-years">10.12.1964 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        
                        <!-- Мои братья и сестры -->
                        <div class="person-card paternal-line" data-id="viktor">
                            <div class="person-name">Виктор</div>
                            <div class="person-years">22.08.1939 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="suktar">
                            <div class="person-name">Суктар-оол</div>
                            <div class="person-years">14.09.1944 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="bolato">
                            <div class="person-name">Болат-оол</div>
                            <div class="person-years">25.05.1947 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="kanool">
                            <div class="person-name">Кан-оол</div>
                            <div class="person-years">19.10.1949 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="valia">
                            <div class="person-name">Валентина</div>
                            <div class="person-years">25.08.1951 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="boris">
                            <div class="person-name">Борис</div>
                            <div class="person-years">05.10.1953 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="vladimir">
                            <div class="person-name">Владимир</div>
                            <div class="person-years">12.02.1956 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="alex" id="me">
                            <div class="person-name">Александр</div>
                            <div class="person-years">06.06.1959 г.</div>
                            <div class="person-relation">я</div>
                        </div>
                        <div class="person-card paternal-line" data-id="alexey">
                            <div class="person-name">Алексей</div>
                            <div class="person-years">05.07.1961 г.</div>
                        </div>
                        <div class="person-card paternal-line" data-id="olga">
                            <div class="person-name">Ольга</div>
                            <div class="person-years">25.08.1963 г.</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 5 -->
                <div class="generation" id="gen5">
                    <div class="gen-row">
                        <div class="person-card maternal-line" data-id="dolana">
                            <div class="person-name">Сарыгбай Долана</div>
                            <div class="person-years">23.09.1994 г.</div>
                        </div>
                        <div class="person-card maternal-line" data-id="choig">
                            <div class="person-name">Сарыгбай Чойгаана</div>
                            <div class="person-years">10.11.1996 г.</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 6 -->
                <div class="generation" id="gen6">
                    <div class="gen-row">
                        <div class="person-card maternal-line" data-id="victoria">
                            <div class="person-name">Сарыгбай Виктория</div>
                            <div class="person-years">~2018 г.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">-</button>
                <button class="zoom-btn" onclick="zoomIn()">+</button>
                <button class="zoom-btn" onclick="resetZoom()">↺</button>
            </div>
        </div>

        <!-- ПАНЕЛЬ -->
        <div class="info-sidebar" id="infoSidebar">
            <button class="toggle-panel-btn" onclick="togglePanel()">
                <i class="fas fa-chevron-right"></i> Скрыть панель
            </button>
            
            <div>
                <h3 class="section-title"><i class="fas fa-user"></i> Выбранный человек</h3>
                <div class="selected-info" id="selected-info">
                    <img id="info-photo" class="photo-thumb" src="https://via.placeholder.com/300x120/1f2a36/cccccc?text=Выберите+человека" alt="фото">
                    <div class="selected-name" id="info-name">Кликните на человека</div>
                    <div class="info-details" id="info-details">Выберите человека в древе для просмотра информации</div>
                </div>
                <div class="current-selection" id="current-selection">
                    <strong>Текущий выбор:</strong> нет
                </div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-users"></i> Братья и сестры</h3>
                <div class="siblings-group" id="siblings-list"></div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-info-circle"></i> Примечания</h3>
                <div class="important-note">
                    <p><strong>Основные данные:</strong> На основе записей актов о рождении 1945 года.</p>
                    <p><strong>Место:</strong> Ү-Шынаа, Арбан №2, Тува.</p>
                    <p><strong>МЧАЭ:</strong> мал, чер ажыл-агый эвилели (аратское крестьянское хозяйство)</p>
                </div>
                
                <div class="notes">
                    <p><strong>⚠️ Важное примечание:</strong></p>
                    <p>Могут быть несовпадения имен в виду паспортизации, во избежание несчастных случаев, отдан на воспитание другой семье, по поверьям: чтобы обмануть смерть, болезни.</p>
                </div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-key"></i> Легенда</h3>
                <div class="legend">
                    <div class="legend-item">
                        <div class="paternal-box"></div>
                        <span>Сторона отца</span>
                    </div>
                    <div class="legend-item">
                        <div class="maternal-box"></div>
                        <span>Сторона матери</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ДАННЫЕ ДЛЯ КАРТОЧЕК
        const personDetails = {
            // 1 поколение
            yaar: { name: 'Чооду Яар Сулепей (Чооду Яар Дандар)', birth: '~1860', photo: '', details: 'Прадедушка со стороны отца. Муж Чооду Севил Балчыма.' },
            sevil: { name: 'Чооду Севил Балчыма', birth: '~1865', photo: '', details: 'Прабабушка со стороны отца. Жена Чооду Яар Сулепей.' },
            chambal: { name: 'Чооду Чигжит Чамбал', birth: '~1865', photo: '', details: 'Прадедушка (дед отца). Муж Чооду Седип Сагаан.' },
            sagaan: { name: 'Чооду Седип Сагаан', birth: '~1870', photo: '', details: 'Прабабушка (дед отца). Жена Чооду Чигжит Чамбал.' },
            dolzat: { name: 'Чооду Долзат Чамыян', birth: '~1868', photo: '', details: 'Прабабушка со стороны матери.' },
            danzyn: { name: 'Чооду Данзын Чигжит', birth: '~1863', photo: '', details: 'Прадедушка со стороны матери.' },
            
            // 2 поколение
            dozum: { name: 'Допуу Дозум', birth: '3 августа 1894', photo: 'images/dopuu_dozum.jpg', details: 'Моя бабушка по отцу, мать моего отца. Отец: Чооду Яар Сулепей, мать: Чооду Севил Балчыма. Св-во РЭ №101142, запись 144. Место: Ү-Шынаа, арбан №2.' },
            sirzhim: { name: 'Долгар Сиржим', birth: '10 мая 1899', photo: 'images/dolgar_sirzhim.jpg', details: 'Сестра матери моего отца. Отец: Чооду Яар Дандар, мать: Чооду Севил Балчыма. Св-во РЭ №111810. Место: Ү-Шынаа, арбан №2.' },
            monke: { name: 'Начын Мөңке', birth: '18 сентября 1890', photo: 'images/nachyn_monke.jpg', details: 'Мой дедушка по отцу, отец моего отца. Отец: Чооду Чигжит Чамбал, мать: Чооду Седип Сагаан. Св-во РЭ 101141. Место: Ү-Шынаа, арбан №2.' },
            demchik: { name: 'Чооду Демчиккей Данзын', birth: '15 сентября 1889', photo: 'images/demchikkey.jpg', details: 'Отец моей матери. В записи акта: Темчикей Чаваа. Род деятельности: мал, тараа ажылы кылып чораан. МЧАЭ кежигүүнү. Родители: Чооду Долзат Чамыян и Чооду Данзын Чигжит.' },
            azhyk: { name: 'Чооду Ажыккай Узун ашак уруу', birth: '~1888', photo: 'images/azhykkay.jpg', details: 'Бабушка по материнской линии. Место рождения Ү-Шынаа. В 1945 году ей было 57 лет.' },
            
            // 3 поколение (братья и сестры матери)
            saadak: { name: 'Саадак Астыр', birth: '5 июля 1904', photo: '', details: 'Старший брат моей матери. В документах указаны другие родители: Чооду Дөмүр-оол Өршээ (62 года) и Чооду Ажыккай Тываан (умершая 19.09.1945). Возможно, был отдан на воспитание.' },
            ayyyr: { name: 'Айыыр Дүшбүн', birth: '1 сентября 1909', photo: '', details: 'Старший брат моей матери. Родился в О-Шынаа. В документах указаны другие родители: Шалык Айыыр Барзыңай (49 лет) и Шалык Тыыдый Чамыйан (59 лет). Имена разные, возможно отдан на воспитание.' },
            dapyy: { name: 'Дапый-оол Николай', birth: '10 апреля 1915', photo: '', details: 'Старший брат моей матери. Родился в Ү-Шынаа. Партбилет №7900107, Св-РЭ №111033.' },
            dungmai: { name: 'Чооду Дуңмай', birth: '15 марта 1917', photo: '', details: 'Старшая сестра моей матери. Родилась в Ү-Шынаа.' },
            okashtay: { name: 'Санчат Окаштай Демчикейовна (девичья Чооду Оккаштай Демчиккей)', birth: '1 марта 1920', photo: 'images/okashtay.jpg', details: 'Моя мать. Родилась в сумоне Ү-Шынаа.' },
            diimaa: { name: 'Диимаа Чооду', birth: '8 марта 1922', photo: 'images/diimaa.jpg', details: 'Младшая сестра моей матери. Родилась в Арбан №2, сумон У-Шынаа. Отец: Чооду Туктуг Темчикей (56 лет), мать: Чооду Калчан Ногаан (58 лет). Св-во РЭ №111195. Член ВЛКСМ № 22831095.' },
            khuurak: { name: 'Хуурак-оол Чооду', birth: '15 января 1923', photo: 'images/khuurak.jpg', details: 'Младший брат моей матери. Родился в Арбан №2, сумон У-Шынаа. Отец: Темчикей Чаваа Данзын (56 лет), мать: Темчикей Ажыккай Узун (умерла). РЭ №101140. Комсомольский билет №2282416.' },
            chazhil: { name: 'Чажылмаа Елизавета', birth: '3 июля 1929', photo: 'images/chazhil.jpg', details: 'Младшая сестра моей матери. Родилась в Арбан №2, сумон У-Шынаа. Отец: Чооду Демчиккей Данзын (57 лет), мать: Чооду Ажыккай Узун (59 лет). РЭ №111041. Комсомольский билет №22832487. Также есть второе имя: Демчикей Чажалмаа.' },
            onermaa: { name: 'Демчиккей Онермаа', birth: '1 января 1936', photo: '', details: 'Младшая сестра моей матери. Родилась в Арбан №2, сумон У-Шынаа. Отец: Демчиккей Чаваа Данзын (56 лет), мать: Чооду Кускелдей Сурун (43 лет). РЭ №101078.' },
            
            // отец и его родственники
            manchalmaa: { name: 'Чооду Манчалмаа', birth: '10 сентября 1918', photo: 'images/manchalmaa.jpg', details: 'Сестра моего отца. Родители: Начын Мөңке и Допуу Дозум. Муж: Монгал Майдыр.' },
            sandan: { name: 'Санчат Сандан Начынович', birth: '1 августа 1920', photo: 'images/sanchat_sandan.jpg', details: 'Мой отец. Родился в Ү-Шынаа. Родители: Начын Мөңке и Допуу Дозум. Св-во РЭ№101228, запись №65. МЧАЭде 10 дугаар.' },
            sandal: { name: 'Начын Саңдал', birth: '15 февраля 1924', photo: 'images/sandal.jpg', details: 'Младший брат моего отца. Родители: Начын Мөңке и Допуу Дозум. Св-во РЭ 101172.' },
            sanmaa: { name: 'Дөмүр-оол Саңмаа', birth: '31 августа 1931', photo: 'images/sanmaa.jpg', details: 'Сестра моего отца. Родители: Дөмүр-оол Барза Өртээ и Дөмүр-оол Сүржии Яар (возможно отдана на воспитание). Св-во РЭ №111808.' },
            
            // 4 поколение (дети Манчалмаа)
            monge: { name: 'Монгал Мөнге', birth: '30 апреля 1937', photo: 'images/mongal_monge.jpg', details: 'Сын Манчалмаа. Отец: Монгал Майдыр Чапчыт, мать: Монгал Манчалмаа Начын. РЭ №101251.' },
            elizaveta: { name: 'Монгал Елизавета', birth: '30 апреля 1941', photo: 'images/mongal_elizaveta.jpg', details: 'Дочь Манчалмаа. Отец: Монгал Майдыр Чапчыт, мать: Монгал Манчалмаа Начын. РЭ №101252.' },
            diizenmaa: { name: 'Монгал Диизенмаа', birth: '8 августа 1944', photo: 'images/diizenmaa.jpg', details: 'Дочь Манчалмаа. Отец: Монгал Майдыр Чапчыт, мать: Монгал Манчалмаа Начын. Муж: Чагар-оол Седип-оол.' },
            
            // дети Саңмаа
            kechil_vlad: { name: 'Кечил-оол Владимир Сириндикович', birth: '12 февраля 1952', photo: 'images/kechil_ool_vladimir.png', details: 'Сын Саңмаа.' },
            bopuymaa: { name: 'Билчеймаа Бопуймаа Кечил-ооловна', birth: '18 июня 1954', photo: 'images/bilcheymaa_bopuymaa.png', details: 'Дочь Саңмаа.' },
            polum_natalya: { name: 'Полум Наталья Кечил-ооловна', birth: '2 марта 1956', photo: 'images/polum_natalya.png', details: 'Дочь Саңмаа.' },
            chechena: { name: 'Билчеймаа Чечена Кечил-ооловна', birth: '25 апреля 1960', photo: 'images/bilcheymaa_chechena.png', details: 'Дочь Саңмаа.' },
            fedor: { name: 'Билчеймаа Федор Кечил-оолович', birth: '28 января 1958', photo: '', details: 'Сын Саңмаа.' },
            mikhail: { name: 'Билчеймаа Михаил Кечил-оолович', birth: '1 декабря 1961', photo: 'images/bilcheymaa_misha.png', details: 'Сын Саңмаа.' },
            saida: { name: 'Сарыгбай Саида Кечил-ооловна', birth: '10 декабря 1964', photo: 'images/sarygbay_saida.png', details: 'Дочь Саңмаа.' },
            
            // мои братья и сестры
            viktor: { name: 'Санчат Виктор Начынович', birth: '22 августа 1939', photo: '', details: 'Мой брат. Образование: начальное, сред. спец. Род деятельности: пенсионер, вальщик леса, лесник.' },
            suktar: { name: 'Санчат-оол Суктар-оол Санданович', birth: '14 сентября 1944', photo: '', details: 'Мой брат. Образование: сред.спец, инженер-механик. Механик лесхоза.' },
            bolato: { name: 'Санчат Болат-оол Санданович', birth: '25 мая 1947', photo: '', details: 'Мой брат. Образование: среднее. Шофер райпо.' },
            kanool: { name: 'Санчат Кан-оол Санданович', birth: '19 октября 1949', photo: '', details: 'Мой брат. Образование: среднее. Лесник лесхоза.' },
            valia: { name: 'Санчат (Байыр-оол) Валентина Сандановна', birth: '25 августа 1951', photo: '', details: 'Моя сестра. Образование: сред.спец. Бухгалтер.' },
            boris: { name: 'Санчат Борис Санданович', birth: '5 октября 1953', photo: '', details: 'Мой брат. Образование: сред.спец. Рабочий.' },
            vladimir: { name: 'Санчат Владимир Санданович', birth: '12 февраля 1956', photo: '', details: 'Мой брат. Образование: сред.спец. Служащий, мастер райгаза.' },
            alex: { name: 'Санчат Александр Санданович', birth: '6 июня 1959', photo: '', details: 'Я. Родился в Самагалтай. Образование: высшее КФКПИ. Госслужащий, инженер-строитель. РАГС, менеджер-экономист.' },
            alexey: { name: 'Санчат Алексей Санданович', birth: '5 июля 1961', photo: '', details: 'Мой брат. Образование: высшее КФКПИ, инженер-механик. Завуч спорт школы.' },
            olga: { name: 'Санчат Ольга Сандановна', birth: '25 августа 1963', photo: '', details: 'Моя сестра. Образование: сред.спец, Красноярский КООП техникум. Продавец.' },
            
            // 5-6 поколение
            dolana: { name: 'Сарыгбай Долана Владимировна', birth: '23 сентября 1994', photo: '', details: 'Дочь Сарыгбай Саиды.' },
            choig: { name: 'Сарыгбай Чойгаана Владимировна', birth: '10 ноября 1996', photo: '', details: 'Дочь Сарыгбай Саиды.' },
            victoria: { name: 'Сарыгбай Виктория', birth: '~2018', photo: '', details: 'Дочь Сарыгбай Чойгааны.' }
        };

        // Состояние панели
        let panelVisible = true;
        let currentSelectedId = null;

        function togglePanel() {
            const panel = document.getElementById('infoSidebar');
            panelVisible = !panelVisible;
            if (panelVisible) {
                panel.classList.remove('hidden');
                panel.querySelector('.toggle-panel-btn').innerHTML = '<i class="fas fa-chevron-right"></i> Скрыть панель';
            } else {
                panel.classList.add('hidden');
                panel.querySelector('.toggle-panel-btn').innerHTML = '<i class="fas fa-chevron-left"></i> Показать панель';
            }
        }

        // Клик вне человека - скрываем панель
        document.getElementById('treeWrapper').addEventListener('click', function(e) {
            if (!e.target.closest('.person-card')) {
                if (panelVisible) {
                    togglePanel();
                }
            }
        });

        // Функция для получения братьев и сестер человека
        function getSiblings(personId) {
            const siblingGroups = {
                // Братья и сестры матери
                saadak: ['ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'],
                ayyyr: ['saadak', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'],
                dapyy: ['saadak', 'ayyyr', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'],
                dungmai: ['saadak', 'ayyyr', 'dapyy', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'],
                okashtay: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'diimaa', 'khuurak', 'chazhil', 'onermaa'],
                diimaa: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'khuurak', 'chazhil', 'onermaa'],
                khuurak: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'chazhil', 'onermaa'],
                chazhil: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'onermaa'],
                onermaa: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil'],
                
                // Братья и сестры отца
                sandan: ['manchalmaa', 'sandal', 'sanmaa'],
                manchalmaa: ['sandan', 'sandal', 'sanmaa'],
                sandal: ['sandan', 'manchalmaa', 'sanmaa'],
                sanmaa: ['sandan', 'manchalmaa', 'sandal'],
                
                // Дети Манчалмаа
                monge: ['elizaveta', 'diizenmaa'],
                elizaveta: ['monge', 'diizenmaa'],
                diizenmaa: ['monge', 'elizaveta'],
                
                // Дети Саңмаа
                kechil_vlad: ['bopuymaa', 'polum_natalya', 'chechena', 'fedor', 'mikhail', 'saida'],
                bopuymaa: ['kechil_vlad', 'polum_natalya', 'chechena', 'fedor', 'mikhail', 'saida'],
                polum_natalya: ['kechil_vlad', 'bopuymaa', 'chechena', 'fedor', 'mikhail', 'saida'],
                chechena: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'fedor', 'mikhail', 'saida'],
                fedor: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'chechena', 'mikhail', 'saida'],
                mikhail: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'chechena', 'fedor', 'saida'],
                saida: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'chechena', 'fedor', 'mikhail'],
                
                // Мои братья и сестры
                alex: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alexey', 'olga'],
                viktor: ['alex', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alexey', 'olga'],
                suktar: ['viktor', 'alex', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alexey', 'olga'],
                bolato: ['viktor', 'suktar', 'alex', 'kanool', 'valia', 'boris', 'vladimir', 'alexey', 'olga'],
                kanool: ['viktor', 'suktar', 'bolato', 'alex', 'valia', 'boris', 'vladimir', 'alexey', 'olga'],
                valia: ['viktor', 'suktar', 'bolato', 'kanool', 'alex', 'boris', 'vladimir', 'alexey', 'olga'],
                boris: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'alex', 'vladimir', 'alexey', 'olga'],
                vladimir: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'alex', 'alexey', 'olga'],
                alexey: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alex', 'olga'],
                olga: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alexey', 'alex']
            };
            
            return siblingGroups[personId] || [];
        }

        // Клик по человеку
        document.querySelectorAll('.person-card').forEach(card => {
            card.addEventListener('click', (e) => {
                e.stopPropagation();
                
                if (!panelVisible) {
                    togglePanel();
                }
                
                const id = card.dataset.id;
                currentSelectedId = id;
                
                // Подсветка
                highlightRelatives(id);
                
                // Обновляем информацию
                updateInfoPanel(id);
                
                // Обновляем список братьев и сестер
                updateSiblingsList(id);
                
                // Подсветка линий
                document.querySelectorAll('#lineSvg path').forEach(p => p.classList.remove('highlighted-path'));
                setTimeout(() => {
                    document.querySelectorAll('#lineSvg path').forEach(p => p.classList.add('highlighted-path'));
                }, 50);
                setTimeout(() => {
                    document.querySelectorAll('#lineSvg path').forEach(p => p.classList.remove('highlighted-path'));
                }, 800);
            });
        });

        function highlightRelatives(selectedId) {
            document.querySelectorAll('.person-card').forEach(c => {
                c.classList.remove('highlighted', 'dimmed', 'main-person');
            });
            
            const selected = document.querySelector(`[data-id="${selectedId}"]`);
            if (!selected) return;
            
            selected.classList.add('main-person');
            
            const relatives = new Set();
            relatives.add(selectedId);
            
            // Добавляем родителей и детей
            simplifiedPairs.forEach(pair => {
                if (pair.parents && pair.parents.includes(selectedId)) {
                    pair.children.forEach(child => relatives.add(child));
                }
                if (pair.children && pair.children.includes(selectedId)) {
                    pair.parents.forEach(parent => relatives.add(parent));
                }
            });
            
            document.querySelectorAll('.person-card').forEach(card => {
                const cardId = card.dataset.id;
                if (!relatives.has(cardId)) {
                    card.classList.add('dimmed');
                } else if (cardId !== selectedId) {
                    card.classList.add('highlighted');
                }
            });
        }

        function updateInfoPanel(id) {
            const person = personDetails[id];
            if (!person) return;
            
            document.getElementById('info-name').textContent = person.name;
            document.getElementById('info-details').innerHTML = `
                ${person.birth ? `<div class="info-row"><span class="info-label">Рождение:</span><span>${person.birth} г.</span></div>` : ''}
                <div style="margin-top: 10px;">${person.details || 'Нет дополнительной информации'}</div>
            `;
            
            const photo = document.getElementById('info-photo');
            if (person.photo) {
                photo.src = person.photo;
                photo.alt = person.name;
            } else {
                photo.src = 'https://via.placeholder.com/300x120/1f2a36/cccccc?text=Нет+фото';
            }
            
            document.getElementById('current-selection').innerHTML = 
                `<strong>Текущий выбор:</strong> ${person.name}`;
        }

        function updateSiblingsList(personId) {
            const siblings = getSiblings(personId);
            const container = document.getElementById('siblings-list');
            container.innerHTML = '';
            
            if (siblings.length === 0) {
                container.innerHTML = '<div style="color: #888;">Нет братьев и сестер</div>';
                return;
            }
            
            siblings.forEach(sibId => {
                const sib = personDetails[sibId];
                if (!sib) return;
                
                const btn = document.createElement('div');
                btn.className = 'sibling';
                btn.textContent = sib.name.split(' ').slice(-1)[0] || sib.name;
                btn.title = sib.name;
                btn.onclick = () => {
                    document.querySelector(`[data-id="${sibId}"]`).click();
                };
                container.appendChild(btn);
            });
        }

        // Упрощенные пары для линий (одна линия от пары родителей к детям)
        const simplifiedPairs = [
            { parents: ['yaar', 'sevil'], children: ['dozum', 'sirzhim'] },
            { parents: ['chambal', 'sagaan'], children: ['monke'] },
            { parents: ['dolzat', 'danzyn'], children: ['demchik', 'azhyk'] },
            { parents: ['dozum', 'monke'], children: ['manchalmaa', 'sandan', 'sandal'] },
            { parents: ['demchik', 'azhyk'], children: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'] },
            { parents: ['manchalmaa'], children: ['monge', 'elizaveta', 'diizenmaa'] },
            { parents: ['sanmaa'], children: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'chechena', 'fedor', 'mikhail', 'saida'] },
            { parents: ['sandan', 'okashtay'], children: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alex', 'alexey', 'olga'] },
            { parents: ['saida'], children: ['dolana', 'choig'] },
            { parents: ['choig'], children: ['victoria'] }
        ];

        // Рисование линий
        function drawLines() {
            const svg = document.getElementById('lineSvg');
            svg.innerHTML = '';
            
            function getElementCenter(id) {
                const el = document.querySelector(`[data-id="${id}"]`);
                if (!el) return null;
                const rect = el.getBoundingClientRect();
                const treeRect = document.getElementById('tree').getBoundingClientRect();
                return {
                    x: rect.left - treeRect.left + rect.width / 2,
                    y: rect.top - treeRect.top + rect.height / 2
                };
            }
            
            simplifiedPairs.forEach(pair => {
                // Находим среднюю точку между родителями
                let parentX = 0;
                let parentCount = 0;
                let parentY = 0;
                let isMaternal = false;
                
                pair.parents.forEach(parentId => {
                    const pt = getElementCenter(parentId);
                    if (pt) {
                        parentX += pt.x;
                        parentY = pt.y; // берем Y последнего родителя
                        parentCount++;
                        const parentCard = document.querySelector(`[data-id="${parentId}"]`);
                        if (parentCard && parentCard.classList.contains('maternal-line')) {
                            isMaternal = true;
                        }
                }
                });
                
                if (parentCount === 0) return;
                parentX /= parentCount;
                
                // Для каждого ребенка рисуем линию
                pair.children.forEach(childId => {
                    const childPt = getElementCenter(childId);
                    if (!childPt) return;
                    
                    const lineClass = isMaternal ? 'maternal-path' : 'paternal-path';
                    
                    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    const midY = (parentY + childPt.y) / 2;
                    const d = `M ${parentX},${parentY} C ${parentX},${midY} ${childPt.x},${midY} ${childPt.x},${childPt.y}`;
                    path.setAttribute('d', d);
                    path.classList.add(lineClass);
                    svg.appendChild(path);
                });
            });
        }

        // Масштабирование
        let scale = 1.0;
        function zoomIn() { scale = Math.min(scale + 0.1, 2); applyZoom(); }
        function zoomOut() { scale = Math.max(scale - 0.1, 0.5); applyZoom(); }
        function resetZoom() { scale = 1; applyZoom(); }
        function applyZoom() {
            document.querySelectorAll('.person-card').forEach(p => {
                p.style.transform = `scale(${scale})`;
            });
        }

        // Инициализация
        window.addEventListener('load', () => {
            setTimeout(drawLines, 300);
        });
        window.addEventListener('resize', drawLines);
        document.getElementById('treeWrapper').addEventListener('scroll', drawLines);
    </script>
</body>
</html>
