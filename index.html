<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Генеалогическое древо · 6 поколений</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #0a0c12;
            color: #eef3fc;
            line-height: 1.4;
            height: 100vh;
            overflow: hidden;
        }

        .main-content {
            display: flex;
            height: 100vh;
            position: relative;
        }

        .tree-wrapper {
            flex: 3;
            background: #0f1419;
            overflow: auto;
            position: relative;
            background: radial-gradient(circle at 30% 30%, #17212b, #030405);
        }

        .info-sidebar {
            flex: 1;
            min-width: 340px;
            max-width: 400px;
            background: #121a24;
            border-left: 2px solid #3b5e8b;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-shadow: -5px 0 25px rgba(0,0,0,0.7);
            transition: transform 0.3s ease;
            z-index: 1000;
            position: relative;
        }

        .info-sidebar.hidden {
            transform: translateX(100%);
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
        }

        .section-title {
            color: #ffd966;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3b5e8b;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ДЕРЕВО - увеличенные отступы для свободной прокрутки */
        .tree {
            display: flex;
            flex-direction: column;
            min-width: 5500px; /* Значительно увеличено для прокрутки влево/вправо */
            min-height: 3200px;
            padding: 80px 400px 80px 600px; /* Огромные отступы слева и справа */
            position: relative;
        }

        .generation {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            margin-bottom: 200px; /* Увеличено расстояние между поколениями */
            width: 100%;
        }

        .gen-row {
            display: flex;
            flex-wrap: nowrap;
            gap: 80px; /* Увеличено расстояние между карточками */
            justify-content: center;
            position: relative;
        }

        .person-card {
            min-width: 220px;
            max-width: 260px;
            background: #1e2a36;
            border-radius: 20px;
            padding: 18px 12px;
            border: 2px solid;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            z-index: 50;
            backdrop-filter: blur(2px);
            color: #f0f5ff;
        }

        .person-card.paternal-line {
            border-color: #3b82f6;
            box-shadow: 0 0 15px #3b82f6;
        }

        .person-card.maternal-line {
            border-color: #c77dff;
            box-shadow: 0 0 15px #c77dff;
        }

        .person-card.main-person {
            border-color: #ffd966;
            border-width: 4px;
            box-shadow: 0 0 30px gold;
            transform: scale(1.02);
        }

        .person-card.dimmed {
            opacity: 0.3;
            filter: grayscale(0.7);
            transition: 0.3s;
        }

        .person-card.highlighted {
            opacity: 1 !important;
            filter: none !important;
            transform: scale(1.05);
            z-index: 100;
        }

        .person-card:hover {
            transform: scale(1.03);
            box-shadow: 0 0 25px cyan;
        }

        .person-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: white;
            margin-bottom: 5px;
        }

        .person-years {
            font-size: 0.85rem;
            color: #b0c6da;
            margin-bottom: 5px;
        }

        .person-relation {
            font-size: 0.75rem;
            background: #2f3b4b;
            padding: 4px 8px;
            border-radius: 20px;
            display: inline-block;
            color: #ddd;
        }

        /* SVG ЛИНИЙ */
        .connector-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        .connector-svg path, .connector-svg line {
            stroke-width: 3px;
            fill: none;
            stroke-linecap: round;
            transition: all 0.3s;
        }

        .paternal-path {
            stroke: #3b82f6;
            stroke-opacity: 0.6;
        }

        .maternal-path {
            stroke: #c77dff;
            stroke-opacity: 0.6;
        }

        .marriage-line {
            stroke: #ffd966;
            stroke-opacity: 0.8;
            stroke-width: 3px;
            stroke-dasharray: 5,5;
        }

        .highlighted-path {
            stroke: #ffd966 !important;
            filter: drop-shadow(0 0 12px gold);
            stroke-width: 5px !important;
            stroke-opacity: 1 !important;
        }

        /* ПАНЕЛЬ */
        .selected-info {
            background: #1f2a36;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #ffd966;
            margin-bottom: 20px;
        }

        .selected-name {
            font-size: 1.3rem;
            color: #ffd966;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .info-details {
            font-size: 0.9rem;
        }

        .info-row {
            margin-bottom: 8px;
            display: flex;
            border-bottom: 1px solid #2f3b4b;
            padding-bottom: 5px;
        }

        .info-label {
            font-weight: bold;
            min-width: 100px;
            color: #b3caf5;
        }

        .siblings-group, .ancestors-group, .children-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .sibling, .ancestor, .child {
            padding: 6px 12px;
            background: #2a3645;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            border: 1px solid #4d6278;
            transition: 0.2s;
        }

        .sibling:hover, .ancestor:hover, .child:hover {
            background: #3b4b60;
            border-color: #ffd966;
        }

        .sibling.active {
            background: #ffd966;
            color: #1a1a2e;
            font-weight: bold;
            border-color: #fff;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
        }

        .paternal-box {
            width: 16px;
            height: 16px;
            background: #3b82f6;
            border-radius: 4px;
        }

        .maternal-box {
            width: 16px;
            height: 16px;
            background: #c77dff;
            border-radius: 4px;
        }

        .notes {
            background: #1a2633;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #d4a373;
            font-size: 0.85rem;
            margin-top: 15px;
        }

        .important-note {
            background: #1f2e3f;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #4a7bac;
            font-size: 0.85rem;
            margin-top: 10px;
        }

        .current-selection {
            background: #1a2532;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .zoom-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 8px;
        }

        .zoom-btn {
            background: #2a3b4c;
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            border: 1px solid #5f7f9f;
        }

        .toggle-panel-btn {
            background: #ffd966;
            color: #1a1a2e;
            border: none;
            padding: 8px 15px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .photo-container {
            position: relative;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .photo-thumb {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 12px;
            border: 2px solid #3b5e8b;
            background: #1f2a36;
            transition: 0.2s;
        }
        
        .photo-thumb:hover {
            opacity: 0.8;
            border-color: #ffd966;
        }
        
        .photo-zoom-icon {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            pointer-events: none;
            border: 1px solid #ffd966;
        }

        .search-container {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            gap: 5px;
            background: #1f2a36;
            padding: 8px 15px;
            border-radius: 40px;
            border: 1px solid #5f7f9f;
        }

        .search-input {
            background: transparent;
            border: none;
            color: white;
            font-size: 0.9rem;
            padding: 5px;
            width: 200px;
            outline: none;
        }

        .search-input::placeholder {
            color: #8a9db0;
        }

        .search-results {
            position: absolute;
            top: 70px;
            left: 20px;
            background: #1f2a36;
            border-radius: 12px;
            border: 1px solid #5f7f9f;
            max-height: 300px;
            overflow-y: auto;
            width: 250px;
            display: none;
            z-index: 2000;
        }

        .search-result-item {
            padding: 10px;
            border-bottom: 1px solid #3f4f60;
            cursor: pointer;
        }

        .search-result-item:hover {
            background: #2f4055;
        }

        /* Модальное окно для фото */
        .photo-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .photo-modal img {
            max-width: 90vw;
            max-height: 90vh;
            object-fit: contain;
            border: 3px solid #ffd966;
            border-radius: 8px;
        }

        .photo-modal .close-btn {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Модальное окно для фото -->
    <div class="photo-modal" id="photoModal" onclick="closePhotoModal()">
        <span class="close-btn">&times;</span>
        <img id="modalImage" src="" alt="Полноразмерное фото">
    </div>

    <div class="main-content">
        <div class="tree-wrapper" id="treeWrapper">
            <!-- Поиск -->
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Поиск по имени...">
                <i class="fas fa-search" style="color: #ffd966;"></i>
            </div>
            <div class="search-results" id="searchResults"></div>

            <div class="tree" id="tree">
                <svg class="connector-svg" id="lineSvg"></svg>
                
                <!-- ПОКОЛЕНИЕ 1 (прадеды) -->
                <div class="generation" id="gen1" style="margin-bottom: 200px;">
                    <div class="gen-row" style="justify-content: space-between; width: 100%;">
                        <!-- сторона отца (синие) -->
                        <div style="display: flex; gap: 60px;">
                            <div class="person-card paternal-line" data-id="yaar" data-side="paternal">
                                <div class="person-name">Чооду Яар Сулепей</div>
                                <div class="person-years">~1860 г.</div>
                                <div class="person-relation">прадедушка (со стороны отца)</div>
                            </div>
                            <div class="person-card paternal-line" data-id="sevil" data-side="paternal">
                                <div class="person-name">Чооду Севил Балчыма</div>
                                <div class="person-years">~1865 г.</div>
                                <div class="person-relation">прабабушка (со стороны отца)</div>
                            </div>
                            <div class="person-card paternal-line" data-id="chambal" data-side="paternal">
                                <div class="person-name">Чооду Чигжит Чамбал</div>
                                <div class="person-years">~1865 г.</div>
                                <div class="person-relation">прадедушка (со стороны отца)</div>
                            </div>
                            <div class="person-card paternal-line" data-id="sagaan" data-side="paternal">
                                <div class="person-name">Чооду Седип Сагаан</div>
                                <div class="person-years">~1870 г.</div>
                                <div class="person-relation">прабабушка (со стороны отца)</div>
                            </div>
                        </div>
                        
                        <div style="color: #6d8eb0; padding: 0 40px;">⸻ разрыв ⸻</div>
                        
                        <!-- сторона матери (лиловые) -->
                        <div style="display: flex; gap: 60px;">
                            <div class="person-card maternal-line" data-id="dolzat" data-side="maternal">
                                <div class="person-name">Чооду Долзат Чамыян</div>
                                <div class="person-years">~1868 г.</div>
                                <div class="person-relation">прабабушка (со стороны матери)</div>
                            </div>
                            <div class="person-card maternal-line" data-id="danzyn" data-side="maternal">
                                <div class="person-name">Чооду Данзын Чигжит</div>
                                <div class="person-years">~1863 г.</div>
                                <div class="person-relation">прадедушка (со стороны матери)</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 2 (бабушки/дедушки) -->
                <div class="generation" id="gen2" style="margin-bottom: 200px;">
                    <div class="gen-row" style="gap: 80px;">
                        <div class="person-card paternal-line" data-id="dozum">
                            <div class="person-name">Допуу Дозум</div>
                            <div class="person-years">3.08.1894 г.</div>
                            <div class="person-relation">бабушка по отцу</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sirzhim">
                            <div class="person-name">Долгар Сиржим</div>
                            <div class="person-years">10.05.1899 г.</div>
                            <div class="person-relation">сестра матери отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="monke">
                            <div class="person-name">Начын Мөңке</div>
                            <div class="person-years">18.09.1890 г.</div>
                            <div class="person-relation">дедушка по отцу</div>
                        </div>
                        <div class="person-card maternal-line" data-id="demchik">
                            <div class="person-name">Чооду Демчиккей</div>
                            <div class="person-years">15.09.1889 г.</div>
                            <div class="person-relation">дедушка по матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="azhyk">
                            <div class="person-name">Чооду Ажыккай</div>
                            <div class="person-years">~1888 г.</div>
                            <div class="person-relation">бабушка по матери</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 3 (родители, братья, сестры) -->
                <div class="generation" id="gen3" style="margin-bottom: 200px;">
                    <div class="gen-row" style="gap: 50px;">
                        <!-- сторона отца (братья и сестры отца) - слева -->
                        <div class="person-card paternal-line" data-id="samdan">
                            <div class="person-name">Самдан</div>
                            <div class="person-years">?</div>
                            <div class="person-relation">брат отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="manchalmaa">
                            <div class="person-name">Манчалмаа</div>
                            <div class="person-years">10.09.1918 г.</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sandan">
                            <div class="person-name">Санчат Сандан</div>
                            <div class="person-years">1.08.1920 г.</div>
                            <div class="person-relation">отец</div>
                        </div>
                        <div class="person-card paternal-line" data-id="shilimaa">
                            <div class="person-name">Шилимаа</div>
                            <div class="person-years">?</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sandal">
                            <div class="person-name">Саңдал</div>
                            <div class="person-years">15.02.1924 г.</div>
                            <div class="person-relation">брат отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="suldum">
                            <div class="person-name">Сулдум</div>
                            <div class="person-years">?</div>
                            <div class="person-relation">брат отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="sanmaa">
                            <div class="person-name">Саңмаа</div>
                            <div class="person-years">31.08.1931 г.</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="tyvaa">
                            <div class="person-name">Тываа Торжу</div>
                            <div class="person-years">1.05.1930 г.</div>
                            <div class="person-relation">брат отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="bolat">
                            <div class="person-name">Болат</div>
                            <div class="person-years">?</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        <div class="person-card paternal-line" data-id="chagarmaa">
                            <div class="person-name">Чагармаа</div>
                            <div class="person-years">23.08.1936 г.</div>
                            <div class="person-relation">сестра отца</div>
                        </div>
                        
                        <!-- сторона матери (братья и сестры матери) - справа -->
                        <div class="person-card maternal-line" data-id="saadak">
                            <div class="person-name">Саадак Астыр</div>
                            <div class="person-years">05.07.1904 г.</div>
                            <div class="person-relation">ст. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="ayyyr">
                            <div class="person-name">Айыыр Дүшбүн</div>
                            <div class="person-years">01.09.1909 г.</div>
                            <div class="person-relation">ст. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="dapyy">
                            <div class="person-name">Дапый-оол Н.</div>
                            <div class="person-years">10.04.1915 г.</div>
                            <div class="person-relation">ст. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="dungmai">
                            <div class="person-name">Чооду Дуңмай</div>
                            <div class="person-years">15.03.1917 г.</div>
                            <div class="person-relation">ст. сестра матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="okashtay" id="mother">
                            <div class="person-name">Санчат Окаштай</div>
                            <div class="person-years">01.03.1920 г.</div>
                            <div class="person-relation">мать</div>
                        </div>
                        <div class="person-card maternal-line" data-id="diimaa">
                            <div class="person-name">Диимаа</div>
                            <div class="person-years">08.03.1922 г.</div>
                            <div class="person-relation">мл. сестра матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="khuurak">
                            <div class="person-name">Хуурак-оол</div>
                            <div class="person-years">15.01.1923 г.</div>
                            <div class="person-relation">мл. брат матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="chazhil">
                            <div class="person-name">Чажылмаа Е.</div>
                            <div class="person-years">03.07.1929 г.</div>
                            <div class="person-relation">мл. сестра матери</div>
                        </div>
                        <div class="person-card maternal-line" data-id="onermaa">
                            <div class="person-name">Онермаа</div>
                            <div class="person-years">01.01.1936 г.</div>
                            <div class="person-relation">мл. сестра матери</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 4 (я, братья/сестры, дети Манчалмаа и Саңмаа) -->
                <div class="generation" id="gen4" style="margin-bottom: 200px;">
                    <div class="gen-row" style="gap: 40px;">
                        <!-- Дети Манчалмаа -->
                        <div class="person-card paternal-line" data-id="monge">
                            <div class="person-name">Монгал Мөнге</div>
                            <div class="person-years">30.04.1937 г.</div>
                            <div class="person-relation">сын Манчалмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="elizaveta">
                            <div class="person-name">Монгал Елизавета</div>
                            <div class="person-years">30.04.1941 г.</div>
                            <div class="person-relation">дочь Манчалмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="diizenmaa">
                            <div class="person-name">Монгал Диизенмаа</div>
                            <div class="person-years">08.08.1944 г.</div>
                            <div class="person-relation">дочь Манчалмаа</div>
                        </div>
                        
                        <!-- Дети Саңмаа -->
                        <div class="person-card paternal-line" data-id="kechil_vlad">
                            <div class="person-name">Кечил-оол В.</div>
                            <div class="person-years">12.02.1952 г.</div>
                            <div class="person-relation">сын Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="bopuymaa">
                            <div class="person-name">Билчеймаа Б.</div>
                            <div class="person-years">18.06.1954 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="polum_natalya">
                            <div class="person-name">Полум Наталья</div>
                            <div class="person-years">02.03.1956 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="chechena">
                            <div class="person-name">Чагар-оол Ч.</div>
                            <div class="person-years">25.04.1960 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="fedor">
                            <div class="person-name">Билчеймаа Ф.</div>
                            <div class="person-years">28.01.1958 г.</div>
                            <div class="person-relation">сын Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="mikhail">
                            <div class="person-name">Билчеймаа М.</div>
                            <div class="person-years">01.12.1961 г.</div>
                            <div class="person-relation">сын Саңмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="saida">
                            <div class="person-name">Сарыгбай Саида</div>
                            <div class="person-years">10.12.1964 г.</div>
                            <div class="person-relation">дочь Саңмаа</div>
                        </div>
                        
                        <!-- Мои братья и сестры -->
                        <div class="person-card paternal-line" data-id="viktor">
                            <div class="person-name">Виктор</div>
                            <div class="person-years">22.08.1939 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="suktar">
                            <div class="person-name">Суктар-оол</div>
                            <div class="person-years">14.09.1944 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="bolato">
                            <div class="person-name">Болат-оол</div>
                            <div class="person-years">25.05.1947 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="kanool">
                            <div class="person-name">Кан-оол</div>
                            <div class="person-years">19.10.1949 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="valia">
                            <div class="person-name">Валентина</div>
                            <div class="person-years">25.08.1951 г.</div>
                            <div class="person-relation">сестра</div>
                        </div>
                        <div class="person-card paternal-line" data-id="boris">
                            <div class="person-name">Борис</div>
                            <div class="person-years">05.10.1953 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="vladimir">
                            <div class="person-name">Владимир</div>
                            <div class="person-years">12.02.1956 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="alex" id="me">
                            <div class="person-name">Александр</div>
                            <div class="person-years">06.06.1959 г.</div>
                            <div class="person-relation">я</div>
                        </div>
                        <div class="person-card paternal-line" data-id="alexey">
                            <div class="person-name">Алексей</div>
                            <div class="person-years">05.07.1961 г.</div>
                            <div class="person-relation">брат</div>
                        </div>
                        <div class="person-card paternal-line" data-id="olga">
                            <div class="person-name">Ольга</div>
                            <div class="person-years">25.08.1963 г.</div>
                            <div class="person-relation">сестра</div>
                        </div>
                        
                        <!-- Мужья -->
                        <div class="person-card paternal-line" data-id="mongal_maidyr">
                            <div class="person-name">Монгал Майдыр</div>
                            <div class="person-years">12.02.1916 г.</div>
                            <div class="person-relation">муж Манчалмаа</div>
                        </div>
                        <div class="person-card paternal-line" data-id="chagarool_sedipool">
                            <div class="person-name">Чагар-оол Седип-оол</div>
                            <div class="person-years">15.01.1940 г.</div>
                            <div class="person-relation">муж Диизенмаа</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 5 (дети Саиды) -->
                <div class="generation" id="gen5" style="margin-bottom: 180px;">
                    <div class="gen-row">
                        <div class="person-card maternal-line" data-id="dolana">
                            <div class="person-name">Сарыгбай Долана</div>
                            <div class="person-years">23.09.1994 г.</div>
                            <div class="person-relation">дочь Саиды</div>
                        </div>
                        <div class="person-card maternal-line" data-id="choig">
                            <div class="person-name">Сарыгбай Чойгаана</div>
                            <div class="person-years">10.11.1996 г.</div>
                            <div class="person-relation">дочь Саиды</div>
                        </div>
                    </div>
                </div>
                
                <!-- ПОКОЛЕНИЕ 6 -->
                <div class="generation" id="gen6">
                    <div class="gen-row">
                        <div class="person-card maternal-line" data-id="victoria">
                            <div class="person-name">Сарыгбай Виктория</div>
                            <div class="person-years">~2018 г.</div>
                            <div class="person-relation">дочь Чойгааны</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">-</button>
                <button class="zoom-btn" onclick="zoomIn()">+</button>
                <button class="zoom-btn" onclick="resetZoom()">↺</button>
            </div>
        </div>

        <!-- ПАНЕЛЬ -->
        <div class="info-sidebar" id="infoSidebar">
            <button class="toggle-panel-btn" onclick="togglePanel()">
                <i class="fas fa-chevron-right"></i> Скрыть панель
            </button>
            
            <div>
                <h3 class="section-title"><i class="fas fa-user"></i> Выбранный человек</h3>
                <div class="selected-info" id="selected-info">
                    <div class="photo-container" onclick="openPhotoModal()">
                        <img id="info-photo" class="photo-thumb" src="https://via.placeholder.com/300x120/1f2a36/cccccc?text=Выберите+человека" alt="фото">
                        <div class="photo-zoom-icon"><i class="fas fa-search-plus"></i></div>
                    </div>
                    <div class="selected-name" id="info-name">Кликните на человека</div>
                    <div class="info-details" id="info-details">Выберите человека в древе для просмотра информации</div>
                </div>
                <div class="current-selection" id="current-selection">
                    <strong>Текущий выбор:</strong> нет
                </div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-arrow-up"></i> Предки</h3>
                <div class="ancestors-group" id="ancestors-list"></div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-users"></i> Братья и сестры</h3>
                <div class="siblings-group" id="siblings-list"></div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-arrow-down"></i> Дети</h3>
                <div class="children-group" id="children-list"></div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-info-circle"></i> Примечания</h3>
                <div class="important-note">
                    <p><strong>Основные данные:</strong> На основе записей актов о рождении 1945 года.</p>
                    <p><strong>Место:</strong> Ү-Шынаа, Арбан №2, Тува.</p>
                    <p><strong>МЧАЭ:</strong> мал, чер ажыл-агый эвилели (аратское крестьянское хозяйство)</p>
                </div>
                
                <div class="notes">
                    <p><strong>⚠️ Важное примечание:</strong></p>
                    <p>Могут быть несовпадения имен в виду паспортизации, во избежание несчастных случаев, отдан на воспитание другой семье, по поверьям: чтобы обмануть смерть, болезни.</p>
                </div>
            </div>

            <div style="margin-top: 20px;">
                <h3 class="section-title"><i class="fas fa-key"></i> Легенда</h3>
                <div class="legend">
                    <div class="legend-item">
                        <div class="paternal-box"></div>
                        <span>Сторона отца</span>
                    </div>
                    <div class="legend-item">
                        <div class="maternal-box"></div>
                        <span>Сторона матери</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ДАННЫЕ ДЛЯ КАРТОЧЕК
        const personDetails = {
            yaar: { name: 'Чооду Яар Сулепей (Чооду Яар Дандар)', birth: '~1860', photo: '', details: 'Прадедушка со стороны отца. Муж Чооду Севил Балчыма.' },
            sevil: { name: 'Чооду Севил Балчыма', birth: '~1865', photo: '', details: 'Прабабушка со стороны отца. Жена Чооду Яар Сулепей.' },
            chambal: { name: 'Чооду Чигжит Чамбал', birth: '~1865', photo: '', details: 'Прадедушка со стороны отца. Муж Чооду Седип Сагаан.' },
            sagaan: { name: 'Чооду Седип Сагаан', birth: '~1870', photo: '', details: 'Прабабушка со стороны отца. Жена Чооду Чигжит Чамбал.' },
            dolzat: { name: 'Чооду Долзат Чамыян', birth: '~1868', photo: '', details: 'Прабабушка со стороны матери.' },
            danzyn: { name: 'Чооду Данзын Чигжит', birth: '~1863', photo: '', details: 'Прадедушка со стороны матери.' },
            
            dozum: { name: 'Допуу Дозум', birth: '3 августа 1894', photo: 'images/dopuu_dozum.jpg', details: 'Моя бабушка по отцу, мать моего отца. Отец: Чооду Яар Сулепей, мать: Чооду Севил Балчыма. Св-во РЭ №101142, запись 144. Место: Ү-Шынаа, арбан №2.' },
            sirzhim: { name: 'Долгар Сиржим', birth: '10 мая 1899', photo: 'images/dolgar_sirzhim.jpg', details: 'Сестра матери моего отца. Отец: Чооду Яар Дандар, мать: Чооду Севил Балчыма. Св-во РЭ №111810. Место: Ү-Шынаа, арбан №2.' },
            monke: { name: 'Начын Мөңке', birth: '18 сентября 1890', photo: 'images/nachyn_monke.jpg', details: 'Мой дедушка по отцу, отец моего отца. Отец: Чооду Чигжит Чамбал, мать: Чооду Седип Сагаан. Св-во РЭ 101141. Место: Ү-Шынаа, арбан №2.' },
            demchik: { name: 'Чооду Демчиккей Данзын', birth: '15 сентября 1889', photo: 'images/demchikkey.jpg', details: 'Отец моей матери. В записи акта: Темчикей Чаваа. Род деятельности: мал, тараа ажылы кылып чораан. МЧАЭ кежигүүнү. Родители: Чооду Долзат Чамыян и Чооду Данзын Чигжит.' },
            azhyk: { name: 'Чооду Ажыккай Узун ашак уруу', birth: '~1888', photo: 'images/azhykkay.jpg', details: 'Бабушка по материнской линии. Место рождения Ү-Шынаа. В 1945 году ей было 57 лет.' },
            
            saadak: { name: 'Саадак Астыр', birth: '5 июля 1904', photo: '', details: 'Старший брат моей матери. В документах указаны другие родители: Чооду Дөмүр-оол Өршээ (62 года) и Чооду Ажыккай Тываан (умершая 19.09.1945). Возможно, был отдан на воспитание.' },
            ayyyr: { name: 'Айыыр Дүшбүн', birth: '1 сентября 1909', photo: '', details: 'Старший брат моей матери. Родился в О-Шынаа. В документах указаны другие родители: Шалык Айыыр Барзыңай (49 лет) и Шалык Тыыдый Чамыйан (59 лет). Имена разные, возможно отдан на воспитание.' },
            dapyy: { name: 'Дапый-оол Николай', birth: '10 апреля 1915', photo: '', details: 'Старший брат моей матери. Родился в Ү-Шынаа. Партбилет №7900107, Св-РЭ №111033.' },
            dungmai: { name: 'Чооду Дуңмай', birth: '15 марта 1917', photo: '', details: 'Старшая сестра моей матери. Родилась в Ү-Шынаа.' },
            okashtay: { name: 'Санчат Окаштай Демчикейовна (девичья Чооду Оккаштай Демчиккей)', birth: '1 марта 1920', photo: 'images/okashtay.jpg', details: 'Моя мать. Родилась в сумоне Ү-Шынаа.' },
            diimaa: { name: 'Диимаа Чооду', birth: '8 марта 1922', photo: 'images/diimaa.jpg', details: 'Младшая сестра моей матери. Родилась в Арбан №2, сумон У-Шынаа. Отец: Чооду Туктуг Темчикей (56 лет), мать: Чооду Калчан Ногаан (58 лет). Св-во РЭ №111195. Член ВЛКСМ № 22831095.' },
            khuurak: { name: 'Хуурак-оол Чооду', birth: '15 января 1923', photo: 'images/khuurak.jpg', details: 'Младший брат моей матери. Родился в Арбан №2, сумон У-Шынаа. Отец: Темчикей Чаваа Данзын (56 лет), мать: Темчикей Ажыккай Узун (умерла). РЭ №101140. Комсомольский билет №2282416.' },
            chazhil: { name: 'Чажылмаа Елизавета', birth: '3 июля 1929', photo: 'images/chazhil.jpg', details: 'Младшая сестра моей матери. Родилась в Арбан №2, сумон У-Шынаа. Отец: Чооду Демчиккей Данзын (57 лет), мать: Чооду Ажыккай Узун (59 лет). РЭ №111041. Комсомольский билет №22832487. Также есть второе имя: Демчикей Чажалмаа.' },
            onermaa: { name: 'Демчиккей Онермаа', birth: '1 января 1936', photo: '', details: 'Младшая сестра моей матери. Родилась в Арбан №2, сумон У-Шынаа. Отец: Демчиккей Чаваа Данзын (56 лет), мать: Чооду Кускелдей Сурун (43 лет). РЭ №101078.' },
            
            samdan: { name: 'Самдан', birth: '', photo: '', details: 'Родной старший брат моего отца.' },
            manchalmaa: { name: 'Чооду Манчалмаа', birth: '10 сентября 1918', photo: 'images/manchalmaa.jpg', details: 'Сестра моего отца. Родители: Начын Мөңке и Допуу Дозум. Муж: Монгал Майдыр.' },
            sandan: { name: 'Санчат Сандан Начынович', birth: '1 августа 1920', photo: 'images/sanchat_sandan.jpg', details: 'Мой отец. Родился в Ү-Шынаа. Родители: Начын Мөңке и Допуу Дозум. Св-во РЭ№101228, запись №65. МЧАЭде 10 дугаар.' },
            shilimaa: { name: 'Шилимаа', birth: '', photo: '', details: 'Младшая сестра моего отца.' },
            sandal: { name: 'Начын Саңдал', birth: '15 февраля 1924', photo: 'images/sandal.jpg', details: 'Младший брат моего отца. Родители: Начын Мөңке и Допуу Дозум. Св-во РЭ 101172.' },
            suldum: { name: 'Сулдум', birth: '', photo: '', details: 'Младший брат моего отца.' },
            sanmaa: { name: 'Дөмүр-оол Саңмаа', birth: '31 августа 1931', photo: 'images/sanmaa.jpg', details: 'Сестра моего отца. Родители: Дөмүр-оол Барза Өртээ и Дөмүр-оол Сүржии Яар (возможно отдана на воспитание). Св-во РЭ №111808.' },
            tyvaa: { name: 'Тываа Торжу', birth: '1 мая 1930', photo: 'images/tyvaa.jpg', details: 'Младший брат моего отца. Родители: Начын Мөңке и Допуу Дозум. Св-во РЭ №138002.' },
            bolat: { name: 'Болат', birth: '', photo: '', details: 'Младшая сестра моего отца.' },
            chagarmaa: { name: 'Начын Чагармаа', birth: '23 августа 1936', photo: 'images/chagarmaa.jpg', details: 'Младшая сестра моего отца. Родители: Начын Мөңке и Допуу Дозум. РЭ №101139.' },
            
            monge: { name: 'Монгал Мөнге', birth: '30 апреля 1937', photo: 'images/mongal_monge.jpg', details: 'Сын Манчалмаа. Отец: Монгал Майдыр Чапчыт, мать: Монгал Манчалмаа Начын. РЭ №101251.' },
            elizaveta: { name: 'Монгал Елизавета', birth: '30 апреля 1941', photo: 'images/mongal_elizaveta.jpg', details: 'Дочь Манчалмаа. Отец: Монгал Майдыр Чапчыт, мать: Монгал Манчалмаа Начын. РЭ №101252.' },
            diizenmaa: { name: 'Монгал Диизенмаа', birth: '8 августа 1944', photo: 'images/diizenmaa.jpg', details: 'Дочь Манчалмаа. Отец: Монгал Майдыр Чапчыт, мать: Монгал Манчалмаа Начын. Муж: Чагар-оол Седип-оол.' },
            
            kechil_vlad: { name: 'Кечил-оол Владимир Сириндикович', birth: '12 февраля 1952', photo: 'images/kechil_ool_vladimir.png', details: 'Сын Саңмаа.' },
            bopuymaa: { name: 'Билчеймаа Бопуймаа Кечил-ооловна', birth: '18 июня 1954', photo: 'images/bilcheymaa_bopuymaa.png', details: 'Дочь Саңмаа.' },
            polum_natalya: { name: 'Полум Наталья Кечил-ооловна', birth: '2 марта 1956', photo: 'images/polum_natalya.png', details: 'Дочь Саңмаа.' },
            chechena: { name: 'Билчеймаа Чечена Кечил-ооловна', birth: '25 апреля 1960', photo: 'images/bilcheymaa_chechena.png', details: 'Дочь Саңмаа.' },
            fedor: { name: 'Билчеймаа Федор Кечил-оолович', birth: '28 января 1958', photo: '', details: 'Сын Саңмаа.' },
            mikhail: { name: 'Билчеймаа Михаил Кечил-оолович', birth: '1 декабря 1961', photo: 'images/bilcheymaa_misha.png', details: 'Сын Саңмаа.' },
            saida: { name: 'Сарыгбай Саида Кечил-ооловна', birth: '10 декабря 1964', photo: 'images/sarygbay_saida.png', details: 'Дочь Саңмаа.' },
            
            viktor: { name: 'Санчат Виктор Начынович', birth: '22 августа 1939', photo: '', details: 'Мой брат. Образование: начальное, сред. спец. Род деятельности: пенсионер, вальщик леса, лесник.' },
            suktar: { name: 'Санчат-оол Суктар-оол Санданович', birth: '14 сентября 1944', photo: '', details: 'Мой брат. Образование: сред.спец, инженер-механик. Механик лесхоза.' },
            bolato: { name: 'Санчат Болат-оол Санданович', birth: '25 мая 1947', photo: '', details: 'Мой брат. Образование: среднее. Шофер райпо.' },
            kanool: { name: 'Санчат Кан-оол Санданович', birth: '19 октября 1949', photo: '', details: 'Мой брат. Образование: среднее. Лесник лесхоза.' },
            valia: { name: 'Санчат (Байыр-оол) Валентина Сандановна', birth: '25 августа 1951', photo: '', details: 'Моя сестра. Образование: сред.спец. Бухгалтер.' },
            boris: { name: 'Санчат Борис Санданович', birth: '5 октября 1953', photo: '', details: 'Мой брат. Образование: сред.спец. Рабочий.' },
            vladimir: { name: 'Санчат Владимир Санданович', birth: '12 февраля 1956', photo: '', details: 'Мой брат. Образование: сред.спец. Служащий, мастер райгаза.' },
            alex: { name: 'Санчат Александр Санданович', birth: '6 июня 1959', photo: '', details: 'Я. Родился в Самагалтай. Образование: высшее КФКПИ. Госслужащий, инженер-строитель. РАГС, менеджер-экономист.' },
            alexey: { name: 'Санчат Алексей Санданович', birth: '5 июля 1961', photo: '', details: 'Мой брат. Образование: высшее КФКПИ, инженер-механик. Завуч спорт школы.' },
            olga: { name: 'Санчат Ольга Сандановна', birth: '25 августа 1963', photo: '', details: 'Моя сестра. Образование: сред.спец, Красноярский КООП техникум. Продавец.' },
            
            mongal_maidyr: { name: 'Монгал Майдыр Чапчыт', birth: '12 февраля 1916', photo: 'images/mongal_maidyr.jpg', details: 'Муж Манчалмаа. Отец: Чооду Чапчый-оол Солаан, мать: Чооду Чижей Нордуппай. Родители занимаются мал тараа. Место работы: "Он дугаар" МЧАЭде. Место жительства: Ү-Шынаа, арбан №2. Св-во РЭ № 101258.' },
            chagarool_sedipool: { name: 'Чагар-оол Седип-оол', birth: '15 января 1940', photo: 'images/chagarool_sedipool.jpg', details: 'Муж Монгал Диизенмаа. Отец: Чагар-оол Кузума Айыжы, мать: Чагар-оол Ноңчат Сергелең. Родители трудились в МЧАЭ. Отец – МЧАЭ даргазы.' },
            
            dolana: { name: 'Сарыгбай Долана Владимировна', birth: '23 сентября 1994', photo: '', details: 'Дочь Сарыгбай Саиды.' },
            choig: { name: 'Сарыгбай Чойгаана Владимировна', birth: '10 ноября 1996', photo: '', details: 'Дочь Сарыгбай Саиды.' },
            victoria: { name: 'Сарыгбай Виктория', birth: '~2018', photo: '', details: 'Дочь Сарыгбай Чойгааны.' }
        };

        // Связи для предков/детей
        const familyRelations = {
            yaar: { parents: [], children: ['dozum', 'sirzhim'], spouse: 'sevil' },
            sevil: { parents: [], children: ['dozum', 'sirzhim'], spouse: 'yaar' },
            chambal: { parents: [], children: ['monke'], spouse: 'sagaan' },
            sagaan: { parents: [], children: ['monke'], spouse: 'chambal' },
            dolzat: { parents: [], children: ['demchik'], spouse: 'danzyn' },
            danzyn: { parents: [], children: ['demchik'], spouse: 'dolzat' },
            
            dozum: { parents: ['yaar', 'sevil'], children: ['samdan', 'manchalmaa', 'sandan', 'shilimaa', 'sandal', 'suldum', 'sanmaa', 'tyvaa', 'bolat', 'chagarmaa'], spouse: 'monke' },
            monke: { parents: ['chambal', 'sagaan'], children: ['samdan', 'manchalmaa', 'sandan', 'shilimaa', 'sandal', 'suldum', 'sanmaa', 'tyvaa', 'bolat', 'chagarmaa'], spouse: 'dozum' },
            sirzhim: { parents: ['yaar', 'sevil'], children: [], spouse: '' },
            
            demchik: { parents: ['dolzat', 'danzyn'], children: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'], spouse: 'azhyk' },
            azhyk: { parents: [], children: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'], spouse: 'demchik' },
            
            samdan: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            manchalmaa: { parents: ['dozum', 'monke'], children: ['monge', 'elizaveta', 'diizenmaa'], spouse: 'mongal_maidyr' },
            sandan: { parents: ['dozum', 'monke'], children: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alex', 'alexey', 'olga'], spouse: 'okashtay' },
            shilimaa: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            sandal: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            suldum: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            sanmaa: { parents: ['dozum', 'monke'], children: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'chechena', 'fedor', 'mikhail', 'saida'], spouse: '' },
            tyvaa: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            bolat: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            chagarmaa: { parents: ['dozum', 'monke'], children: [], spouse: '' },
            
            okashtay: { parents: ['demchik', 'azhyk'], children: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alex', 'alexey', 'olga'], spouse: 'sandan' },
            saadak: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            ayyyr: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            dapyy: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            dungmai: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            diimaa: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            khuurak: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            chazhil: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            onermaa: { parents: ['demchik', 'azhyk'], children: [], spouse: '' },
            
            monge: { parents: ['manchalmaa', 'mongal_maidyr'], children: [], spouse: '' },
            elizaveta: { parents: ['manchalmaa', 'mongal_maidyr'], children: [], spouse: '' },
            diizenmaa: { parents: ['manchalmaa', 'mongal_maidyr'], children: [], spouse: 'chagarool_sedipool' },
            
            mongal_maidyr: { parents: [], children: ['monge', 'elizaveta', 'diizenmaa'], spouse: 'manchalmaa' },
            chagarool_sedipool: { parents: [], children: [], spouse: 'diizenmaa' },
            
            kechil_vlad: { parents: ['sanmaa'], children: [], spouse: '' },
            bopuymaa: { parents: ['sanmaa'], children: [], spouse: '' },
            polum_natalya: { parents: ['sanmaa'], children: [], spouse: '' },
            chechena: { parents: ['sanmaa'], children: [], spouse: '' },
            fedor: { parents: ['sanmaa'], children: [], spouse: '' },
            mikhail: { parents: ['sanmaa'], children: [], spouse: '' },
            saida: { parents: ['sanmaa'], children: ['dolana', 'choig'], spouse: '' },
            
            viktor: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            suktar: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            bolato: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            kanool: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            valia: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            boris: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            vladimir: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            alex: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            alexey: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            olga: { parents: ['sandan', 'okashtay'], children: [], spouse: '' },
            
            dolana: { parents: ['saida'], children: [], spouse: '' },
            choig: { parents: ['saida'], children: ['victoria'], spouse: '' },
            victoria: { parents: ['choig'], children: [], spouse: '' }
        };

        // Супружеские пары для линий
        const marriedCouples = [
            { husband: 'yaar', wife: 'sevil', children: ['dozum', 'sirzhim'] },
            { husband: 'chambal', wife: 'sagaan', children: ['monke'] },
            { husband: 'danzyn', wife: 'dolzat', children: ['demchik'] },
            { husband: 'monke', wife: 'dozum', children: ['samdan', 'manchalmaa', 'sandan', 'shilimaa', 'sandal', 'suldum', 'sanmaa', 'tyvaa', 'bolat', 'chagarmaa'] },
            { husband: 'demchik', wife: 'azhyk', children: ['saadak', 'ayyyr', 'dapyy', 'dungmai', 'okashtay', 'diimaa', 'khuurak', 'chazhil', 'onermaa'] },
            { husband: 'sandan', wife: 'okashtay', children: ['viktor', 'suktar', 'bolato', 'kanool', 'valia', 'boris', 'vladimir', 'alex', 'alexey', 'olga'] },
            { husband: 'manchalmaa', wife: 'mongal_maidyr', children: ['monge', 'elizaveta', 'diizenmaa'] },
            { husband: 'sanmaa', wife: '', children: ['kechil_vlad', 'bopuymaa', 'polum_natalya', 'chechena', 'fedor', 'mikhail', 'saida'] },
            { husband: 'saida', wife: '', children: ['dolana', 'choig'] },
            { husband: 'diizenmaa', wife: 'chagarool_sedipool', children: [] }
        ];

        let panelVisible = true;
        let currentSelectedId = null;
        let currentPhotoUrl = '';

        function togglePanel() {
            const panel = document.getElementById('infoSidebar');
            panelVisible = !panelVisible;
            if (panelVisible) {
                panel.classList.remove('hidden');
                panel.querySelector('.toggle-panel-btn').innerHTML = '<i class="fas fa-chevron-right"></i> Скрыть панель';
            } else {
                panel.classList.add('hidden');
                panel.querySelector('.toggle-panel-btn').innerHTML = '<i class="fas fa-chevron-left"></i> Показать панель';
            }
        }

        function openPhotoModal() {
            if (currentPhotoUrl && currentPhotoUrl !== 'https://via.placeholder.com/300x120/1f2a36/cccccc?text=Выберите+человека' && !currentPhotoUrl.includes('placeholder')) {
                document.getElementById('modalImage').src = currentPhotoUrl;
                document.getElementById('photoModal').style.display = 'flex';
            }
        }

        function closePhotoModal() {
            document.getElementById('photoModal').style.display = 'none';
        }

        document.getElementById('treeWrapper').addEventListener('click', function(e) {
            if (!e.target.closest('.person-card')) {
                if (panelVisible) {
                    togglePanel();
                }
            }
        });

        document.querySelectorAll('.person-card').forEach(card => {
            card.addEventListener('click', (e) => {
                e.stopPropagation();
                
                if (!panelVisible) {
                    togglePanel();
                }
                
                const id = card.dataset.id;
                currentSelectedId = id;
                
                highlightRelatives(id);
                updateInfoPanel(id);
                updateFamilyLists(id);
                
                document.querySelectorAll('#lineSvg path, #lineSvg line').forEach(p => p.classList.remove('highlighted-path'));
                setTimeout(() => {
                    document.querySelectorAll('#lineSvg path, #lineSvg line').forEach(p => p.classList.add('highlighted-path'));
                }, 50);
                setTimeout(() => {
                    document.querySelectorAll('#lineSvg path, #lineSvg line').forEach(p => p.classList.remove('highlighted-path'));
                }, 800);
            });
        });

        function highlightRelatives(selectedId) {
            document.querySelectorAll('.person-card').forEach(c => {
                c.classList.remove('highlighted', 'dimmed', 'main-person');
            });
            
            const selected = document.querySelector(`[data-id="${selectedId}"]`);
            if (!selected) return;
            
            selected.classList.add('main-person');
            
            const relatives = new Set();
            relatives.add(selectedId);
            
            const rel = familyRelations[selectedId];
            if (rel) {
                rel.parents.forEach(p => relatives.add(p));
                rel.children.forEach(c => relatives.add(c));
                if (rel.spouse) relatives.add(rel.spouse);
            }
            
            document.querySelectorAll('.person-card').forEach(card => {
                const cardId = card.dataset.id;
                if (!relatives.has(cardId)) {
                    card.classList.add('dimmed');
                } else if (cardId !== selectedId) {
                    card.classList.add('highlighted');
                }
            });
        }

        function updateInfoPanel(id) {
            const person = personDetails[id];
            if (!person) return;
            
            document.getElementById('info-name').textContent = person.name;
            document.getElementById('info-details').innerHTML = `
                ${person.birth ? `<div class="info-row"><span class="info-label">Рождение:</span><span>${person.birth} г.</span></div>` : ''}
                <div style="margin-top: 10px;">${person.details || 'Нет дополнительной информации'}</div>
            `;
            
            const photo = document.getElementById('info-photo');
            if (person.photo) {
                photo.src = person.photo;
                currentPhotoUrl = person.photo;
            } else {
                photo.src = 'https://via.placeholder.com/300x120/1f2a36/cccccc?text=Нет+фото';
                currentPhotoUrl = '';
            }
            
            document.getElementById('current-selection').innerHTML = 
                `<strong>Текущий выбор:</strong> ${person.name}`;
        }

        function updateFamilyLists(id) {
            const rel = familyRelations[id];
            if (!rel) return;
            
            const ancestorsList = document.getElementById('ancestors-list');
            ancestorsList.innerHTML = '';
            if (rel.parents && rel.parents.length > 0) {
                rel.parents.forEach(pId => {
                    if (personDetails[pId]) {
                        const btn = document.createElement('div');
                        btn.className = 'ancestor';
                        btn.textContent = personDetails[pId].name.split(' ').slice(0,2).join(' ');
                        btn.title = personDetails[pId].name;
                        btn.onclick = () => document.querySelector(`[data-id="${pId}"]`).click();
                        ancestorsList.appendChild(btn);
                    }
                });
            } else {
                ancestorsList.innerHTML = '<div style="color: #888;">Нет информации о предках</div>';
            }
            
            const siblingsList = document.getElementById('siblings-list');
            siblingsList.innerHTML = '';
            
            if (rel.parents && rel.parents.length > 0) {
                const parent1 = rel.parents[0];
                const parent1Rel = familyRelations[parent1];
                if (parent1Rel && parent1Rel.children) {
                    const siblings = parent1Rel.children.filter(c => c !== id);
                    if (siblings.length > 0) {
                        siblings.forEach(sId => {
                            if (personDetails[sId]) {
                                const btn = document.createElement('div');
                                btn.className = 'sibling';
                                btn.textContent = personDetails[sId].name.split(' ').slice(-1)[0];
                                btn.title = personDetails[sId].name;
                                btn.onclick = () => document.querySelector(`[data-id="${sId}"]`).click();
                                siblingsList.appendChild(btn);
                            }
                        });
                    } else {
                        siblingsList.innerHTML = '<div style="color: #888;">Нет братьев и сестер</div>';
                    }
                } else {
                    siblingsList.innerHTML = '<div style="color: #888;">Нет информации</div>';
                }
            } else {
                siblingsList.innerHTML = '<div style="color: #888;">Нет информации</div>';
            }
            
            const childrenList = document.getElementById('children-list');
            childrenList.innerHTML = '';
            if (rel.children && rel.children.length > 0) {
                rel.children.forEach(cId => {
                    if (personDetails[cId]) {
                        const btn = document.createElement('div');
                        btn.className = 'child';
                        btn.textContent = personDetails[cId].name.split(' ').slice(0,2).join(' ');
                        btn.title = personDetails[cId].name;
                        btn.onclick = () => document.querySelector(`[data-id="${cId}"]`).click();
                        childrenList.appendChild(btn);
                    }
                });
            } else {
                childrenList.innerHTML = '<div style="color: #888;">Нет детей</div>';
            }
        }

        function drawLines() {
            const svg = document.getElementById('lineSvg');
            svg.innerHTML = '';
            
            function getElementCenter(id) {
                const el = document.querySelector(`[data-id="${id}"]`);
                if (!el) return null;
                const rect = el.getBoundingClientRect();
                const treeRect = document.getElementById('tree').getBoundingClientRect();
                return {
                    x: rect.left - treeRect.left + rect.width / 2,
                    y: rect.top - treeRect.top + rect.height / 2
                };
            }
            
            marriedCouples.forEach(couple => {
                let parentX, parentY;
                let isMaternal = false;
                
                if (couple.husband && couple.wife && couple.husband !== '' && couple.wife !== '') {
                    const husbandPt = getElementCenter(couple.husband);
                    const wifePt = getElementCenter(couple.wife);
                    
                    if (!husbandPt || !wifePt) return;
                    
                    parentY = husbandPt.y;
                    const leftX = Math.min(husbandPt.x, wifePt.x);
                    const rightX = Math.max(husbandPt.x, wifePt.x);
                    
                    const marriageLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
                    marriageLine.setAttribute('x1', leftX);
                    marriageLine.setAttribute('y1', parentY);
                    marriageLine.setAttribute('x2', rightX);
                    marriageLine.setAttribute('y2', parentY);
                    marriageLine.classList.add('marriage-line');
                    svg.appendChild(marriageLine);
                    
                    parentX = (husbandPt.x + wifePt.x) / 2;
                    isMaternal = document.querySelector(`[data-id="${couple.wife}"]`).classList.contains('maternal-line');
                } else {
                    const parentId = couple.husband || couple.wife;
                    if (!parentId) return;
                    const parentPt = getElementCenter(parentId);
                    if (!parentPt) return;
                    parentX = parentPt.x;
                    parentY = parentPt.y;
                    isMaternal = document.querySelector(`[data-id="${parentId}"]`).classList.contains('maternal-line');
                }
                
                const lineClass = isMaternal ? 'maternal-path' : 'paternal-path';
                
                couple.children.forEach(childId => {
                    const childPt = getElementCenter(childId);
                    if (!childPt) return;
                    
                    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    const midY = (parentY + childPt.y) / 2;
                    const d = `M ${parentX},${parentY} C ${parentX},${midY} ${childPt.x},${midY} ${childPt.x},${childPt.y}`;
                    path.setAttribute('d', d);
                    path.classList.add(lineClass);
                    svg.appendChild(path);
                });
            });
        }

        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        
        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            if (query.length < 2) {
                searchResults.style.display = 'none';
                return;
            }
            
            const results = [];
            for (const [id, person] of Object.entries(personDetails)) {
                if (person.name.toLowerCase().includes(query)) {
                    results.push({ id, name: person.name });
                }
            }
            
            if (results.length > 0) {
                searchResults.innerHTML = results.map(r => 
                    `<div class="search-result-item" onclick="selectSearchResult('${r.id}')">${r.name}</div>`
                ).join('');
                searchResults.style.display = 'block';
            } else {
                searchResults.innerHTML = '<div class="search-result-item">Ничего не найдено</div>';
                searchResults.style.display = 'block';
            }
        });
        
        window.selectSearchResult = function(id) {
            document.querySelector(`[data-id="${id}"]`).click();
            searchResults.style.display = 'none';
            searchInput.value = '';
        };

        window.openPhotoModal = openPhotoModal;
        window.closePhotoModal = closePhotoModal;
        
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-container')) {
                searchResults.style.display = 'none';
            }
        });

        let scale = 1.0;
        window.zoomIn = function() { scale = Math.min(scale + 0.1, 2); applyZoom(); };
        window.zoomOut = function() { scale = Math.max(scale - 0.1, 0.5); applyZoom(); };
        window.resetZoom = function() { scale = 1; applyZoom(); };
        function applyZoom() {
            document.querySelectorAll('.person-card').forEach(p => {
                p.style.transform = `scale(${scale})`;
            });
        }

        window.addEventListener('load', () => {
            setTimeout(drawLines, 500);
        });
        window.addEventListener('resize', drawLines);
        document.getElementById('treeWrapper').addEventListener('scroll', drawLines);
    </script>
</body>
</html>
