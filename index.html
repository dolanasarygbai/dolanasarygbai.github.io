<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –¥—Ä–µ–≤–æ ‚Äî –ü—Ä–µ–¥–∫–∏ –ø–æ –ª–∏–Ω–∏–∏ –æ—Ç—Ü–∞</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }
        body {
            background: #f0efe7;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .tree-container {
            display: flex;
            max-width: 1600px;
            width: 100%;
            background: #faf9f2;
            border-radius: 32px;
            box-shadow: 0 20px 40px rgba(0,20,10,0.2);
            overflow: hidden;
            backdrop-filter: blur(2px);
            border: 1px solid #d8d0b5;
        }
        /* –æ—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–æ—Ç–Ω–æ –¥–µ—Ä–µ–≤–∞ */
        .tree-canvas {
            flex: 3;
            padding: 30px 20px 40px 20px;
            overflow-x: auto;
            background: #fefcf0;
            background-image: 
                linear-gradient(#e5dec9 1px, transparent 1px),
                linear-gradient(90deg, #e5dec9 1px, transparent 1px);
            background-size: 40px 40px;
            border-right: 2px solid #b7aa8a;
            min-width: 0;
        }
        .tree-wrapper {
            position: relative;
            min-width: 1200px;
        }
        /* –ª–∏–Ω–∏–∏ —Ä–æ–¥—Å—Ç–≤–∞ —Ä–∏—Å—É–µ–º —á–µ—Ä–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ div */
        .lines-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        .line {
            position: absolute;
            background: #9b8c6f;
            border-radius: 4px;
        }
        .vertical-line {
            width: 3px;
            height: 40px;
            background: #7b6e50;
            transform: translateX(-50%);
        }
        .horizontal-line {
            height: 3px;
            background: #7b6e50;
        }
        .nodes-layer {
            position: relative;
            z-index: 5;
            display: flex;
            flex-direction: column;
            gap: 60px;
            padding: 20px 0;
        }
        /* —Å—Ç—É–ø–µ–Ω—å ‚Äî –æ–¥–Ω–æ –ø–æ–∫–æ–ª–µ–Ω–∏–µ */
        .generation-row {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            position: relative;
            min-height: 140px;
        }
        .gen-label {
            width: 100%;
            font-size: 18px;
            font-weight: 600;
            color: #4a3e2b;
            letter-spacing: 1px;
            margin-bottom: 15px;
            border-bottom: 2px dashed #c9b386;
            padding-bottom: 5px;
            text-transform: uppercase;
        }
        /* –∫–∞—Ä—Ç–æ—á–∫–∞ —á–µ–ª–æ–≤–µ–∫–∞ */
        .person-node {
            background: #fff9e6;
            border: 3px solid #b1935c;
            border-radius: 30px 10px 30px 10px;
            min-width: 180px;
            max-width: 220px;
            padding: 12px 10px 8px 10px;
            box-shadow: 8px 8px 0 #7b5f3a;
            cursor: pointer;
            transition: 0.1s linear;
            text-align: center;
            font-size: 14px;
            line-height: 1.3;
            color: #2d2a1f;
            position: relative;
            background: #fff9e6 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23b1935c" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="M21 15l-5-5L7 21"></path></svg>') no-repeat 5px 5px;
            background-size: 18px;
        }
        .person-node.selected {
            border-color: #c94f1f;
            background-color: #fcede3;
            box-shadow: 8px 8px 0 #a1451a;
        }
        .person-name {
            font-weight: 700;
            font-size: 15px;
            margin-top: 15px;
            color: #3d2f15;
        }
        .person-details {
            font-size: 12px;
            color: #5f4e30;
            margin: 4px 0;
        }
        .person-photo-placeholder {
            width: 50px;
            height: 50px;
            background: #d9cbad;
            border: 2px dashed #937b4e;
            border-radius: 50%;
            margin: 5px auto 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #4f3f23;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="%236b5430" stroke-width="1.5"><rect x="2" y="2" width="20" height="20" rx="2.18"/><circle cx="8.5" cy="8.5" r="2.5"/><path d="M21 15l-5-5L6 21"/></svg>');
            background-size: 30px;
            background-repeat: no-repeat;
            background-position: center;
        }
        /* –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-panel {
            flex: 1.2;
            background: #f2e8d5;
            padding: 25px 15px;
            border-left: 3px solid #b7aa8a;
            box-shadow: inset 0 0 20px #ddcfb5;
            overflow-y: auto;
            max-height: 90vh;
            position: sticky;
            top: 20px;
        }
        .info-title {
            font-size: 24px;
            font-weight: 800;
            color: #4f3c1d;
            border-bottom: 3px solid #ac934b;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .info-content {
            background: #fffbf0;
            padding: 20px 15px;
            border-radius: 24px 6px 24px 6px;
            border: 2px solid #bea46a;
            font-size: 15px;
        }
        .info-field {
            margin-bottom: 15px;
            border-left: 5px solid #c5a35b;
            padding-left: 12px;
        }
        .info-field strong {
            color: #3a2c13;
            display: block;
            font-size: 14px;
            text-transform: uppercase;
        }
        .photo-upload {
            margin-top: 20px;
            background: #dacfb4;
            border-radius: 30px;
            padding: 15px;
            text-align: center;
        }
        .photo-upload label {
            background: #8f7a50;
            color: white;
            padding: 8px 20px;
            border-radius: 40px;
            cursor: pointer;
            display: inline-block;
        }
        #person-photo-img {
            max-width: 100%;
            max-height: 150px;
            margin-top: 10px;
            border-radius: 16px;
            border: 3px solid #785f32;
            object-fit: cover;
        }
        .empty-select-msg {
            color: #776b4b;
            font-style: italic;
            text-align: center;
        }
        /* –º–∞–ª–µ–Ω—å–∫–∞—è –º–µ—Ç–∫–∞ —Å—É–ø—Ä—É–≥–∞/—Ä–æ–¥–∏—Ç–µ–ª—å */
        .relation-badge {
            font-size: 10px;
            background: #d1be94;
            color: #242018;
            border-radius: 20px;
            padding: 2px 8px;
            display: inline-block;
            margin: 3px 2px;
        }
    </style>
</head>
<body>
<div class="tree-container">
    <!-- –ª–µ–≤–∞—è —á–∞—Å—Ç—å: –¥–µ—Ä–µ–≤–æ -->
    <div class="tree-canvas">
        <div class="tree-wrapper">
            <div class="lines-layer" id="linesLayer"></div>
            <div class="nodes-layer" id="nodesLayer">
                <!-- –ü–æ–∫–æ–ª–µ–Ω–∏—è –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö -->
            </div>
        </div>
    </div>
    <!-- –ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ —Ñ–æ—Ç–æ -->
    <div class="info-panel" id="infoPanel">
        <div class="info-title">üìú –°–≤–µ–¥–µ–Ω–∏—è –æ –ø—Ä–µ–¥–∫–µ</div>
        <div class="info-content" id="infoContent">
            <div class="empty-select-msg">üëÜ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É —á–µ–ª–æ–≤–µ–∫–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</div>
        </div>
    </div>
</div>

<script>
    (function() {
        // ---------- –ë–ê–ó–ê –î–ê–ù–ù–´–• (–ø–æ –≤–∞—à–µ–º—É –æ–ø–∏—Å–∞–Ω–∏—é) ----------
        const persons = {};

        // –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function addPerson(id, data) { persons[id] = { id, ...data }; }

        // --- –ü–æ–∫–æ–ª–µ–Ω–∏–µ 1: –ø—Ä–∞—Ä–æ–¥–∏—Ç–µ–ª–∏ (–æ—Ç—Ü–æ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è) ---
        addPerson('p1_1', { name: '–ß–æ–æ–¥—É –Ø–∞—Ä –°—É–ª–µ–ø–µ–π (–ß–æ–æ–¥—É –Ø–∞—Ä –î–∞–Ω–¥–∞—Ä)', generation: 1, gender: '–º—É–∂', info: { role: '–ü—Ä–∞–¥–µ–¥—É—à–∫–∞ (–æ—Ç–µ—Ü –±–∞–±—É—à–∫–∏ –ø–æ –æ—Ç—Ü—É)', full: '–ß–æ–æ–¥—É –Ø–∞—Ä –°—É–ª–µ–ø–µ–π', birth: '', death: '', details: '–û—Ç–µ—Ü: ‚Äî, –º–∞—Ç—å: ‚Äî. –í –∑–∞–ø–∏—Å—è—Ö —Ç–∞–∫–∂–µ —Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –∫–∞–∫ –î–∞–Ω–¥–∞—Ä.' } });
        addPerson('p1_2', { name: '–ß–æ–æ–¥—É –°–µ–≤–∏–ª –ë–∞–ª—á—ã–º–∞', generation: 1, gender: '–∂–µ–Ω', info: { role: '–ü—Ä–∞–±–∞–±—É—à–∫–∞ (–º–∞—Ç—å –±–∞–±—É—à–∫–∏ –ø–æ –æ—Ç—Ü—É)', full: '–ß–æ–æ–¥—É –°–µ–≤–∏–ª –ë–∞–ª—á—ã–º–∞', birth: '', details: '–°—É–ø—Ä—É–≥–∞ –Ø–∞—Ä–∞. –ú–∞—Ç—å –î–æ–∑—É–º –∏ –°–∏—Ä–∂–∏–º.' } });
        // —Ä–æ–¥–∏—Ç–µ–ª–∏ –¥–µ–¥–∞ –ø–æ –æ—Ç—Ü—É
        addPerson('p1_3', { name: '–ß–æ–æ–¥—É –ß–∏–≥–∂–∏—Ç –ß–∞–º–±–∞–ª', generation: 1, gender: '–º—É–∂', info: { role: '–ü—Ä–∞–¥–µ–¥—É—à–∫–∞ (–æ—Ç–µ—Ü –¥–µ–¥–∞ –ø–æ –æ—Ç—Ü—É)', full: '–ß–æ–æ–¥—É –ß–∏–≥–∂–∏—Ç –ß–∞–º–±–∞–ª', birth: '' } });
        addPerson('p1_4', { name: '–ß–æ–æ–¥—É –°–µ–¥–∏–ø –°–∞–≥–∞–∞–Ω', generation: 1, gender: '–∂–µ–Ω', info: { role: '–ü—Ä–∞–±–∞–±—É—à–∫–∞ (–º–∞—Ç—å –¥–µ–¥–∞ –ø–æ –æ—Ç—Ü—É)', full: '–ß–æ–æ–¥—É –°–µ–¥–∏–ø –°–∞–≥–∞–∞–Ω', birth: '' } });

        // --- –ü–æ–∫–æ–ª–µ–Ω–∏–µ 2: –±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏ —Ä–æ–¥–∏—Ç–µ–ª–∏ –æ—Ç—Ü–∞ ---
        addPerson('p2_1', { name: '–î–æ–ø—É—É –î–æ–∑—É–º', generation: 2, gender: '–∂–µ–Ω', info: { role: '–ë–∞–±—É—à–∫–∞ –ø–æ –æ—Ç—Ü—É (–º–∞—Ç—å –æ—Ç—Ü–∞)', full: '–î–æ–ø—É—É –î–æ–∑—É–º', birth: '3 –∞–≤–≥—É—Å—Ç–∞ 1894', death: '', parents: '–û—Ç–µ—Ü: –ß–æ–æ–¥—É –Ø–∞—Ä –°—É–ª–µ–ø–µ–π, –º–∞—Ç—å: –ß–æ–æ–¥—É –°–µ–≤–∏–ª –ë–∞–ª—á—ã–º–∞', certificate: '–†–≠ ‚Ññ101142, –∑–∞–ø–∏—Å—å 144, –∫–Ω–∏–≥–∞ ‚Ññ1, —Å—Ç—Ä.503', dateRecord: '20 —Å–µ–Ω—Ç—è–±—Ä—è 1945', residence: '“Æ-–®—ã–Ω–∞–∞, –∞—Ä–±–∞–Ω ‚Ññ2' } });
        addPerson('p2_2', { name: '–ù–∞—á—ã–Ω –ú”©“£–∫–µ', generation: 2, gender: '–º—É–∂', info: { role: '–î–µ–¥—É—à–∫–∞ –ø–æ –æ—Ç—Ü—É (–æ—Ç–µ—Ü –æ—Ç—Ü–∞)', full: '–ù–∞—á—ã–Ω –ú”©“£–∫–µ', birth: '18 —Å–µ–Ω—Ç—è–±—Ä—è 1890', parents: '–û—Ç–µ—Ü: –ß–æ–æ–¥—É –ß–∏–≥–∂–∏—Ç –ß–∞–º–±–∞–ª, –º–∞—Ç—å: –ß–æ–æ–¥—É –°–µ–¥–∏–ø –°–∞–≥–∞–∞–Ω', certificate: '–†–≠ 101141, –∑–∞–ø–∏—Å—å 20.09.1945', residence: '“Æ-–®—ã–Ω–∞–∞, –∞—Ä–±–∞–Ω ‚Ññ2' } });
        // —Å–µ—Å—Ç—Ä–∞ –±–∞–±—É—à–∫–∏
        addPerson('p2_3', { name: '–î–æ–ª–≥–∞—Ä –°–∏—Ä–∂–∏–º', generation: 2, gender: '–∂–µ–Ω', info: { role: '–°–µ—Å—Ç—Ä–∞ –º–∞—Ç–µ—Ä–∏ –æ—Ç—Ü–∞', full: '–î–æ–ª–≥–∞—Ä –°–∏—Ä–∂–∏–º', birth: '10 –º–∞—è 1899', parents: '–û—Ç–µ—Ü: –ß–æ–æ–¥—É –Ø–∞—Ä –î–∞–Ω–¥–∞—Ä, –º–∞—Ç—å: –ß–æ–æ–¥—É –°–µ–≤–∏–ª –ë–∞–ª—á—ã–º–∞', certificate: '–†–≠ ‚Ññ111810', residence: '“Æ-–®—ã–Ω–∞–∞, –∞—Ä–±–∞–Ω ‚Ññ2', dateRecord: '22 —Å–µ–Ω—Ç—è–±—Ä—è 1945' } });

        // --- –ü–æ–∫–æ–ª–µ–Ω–∏–µ 3: –æ—Ç–µ—Ü, –µ–≥–æ –±—Ä–∞—Ç—å—è –∏ —Å–µ—Å—Ç—Ä—ã (–¥–µ—Ç–∏ –±–∞–±—É—à–∫–∏ –∏ –¥–µ–¥—É—à–∫–∏) ---
        addPerson('p3_1', { name: '–°–∞–Ω—á–∞—Ç (–°–∞–Ω—á–∞—Ç-–æ–æ–ª) –°–∞–Ω–¥–∞–Ω –ù–∞—á—ã–Ω–æ–≤–∏—á', generation: 3, gender: '–º—É–∂', info: { role: '–ú–æ–π –æ—Ç–µ—Ü', full: '–°–∞–Ω—á–∞—Ç –°–∞–Ω–¥–∞–Ω –ù–∞—á—ã–Ω–æ–≤–∏—á', birth: '1 –∞–≤–≥—É—Å—Ç–∞ 1920, “Æ-–®—ã–Ω–∞–∞', parents: '–û—Ç–µ—Ü: –ß–æ–æ–¥—É –ù–∞—á—ã–Ω –ß–∏–≥–∂–∏—Ç, –º–∞—Ç—å: –ß–æ–æ–¥—É –î–æ–ø—É—É –°–∞–Ω–∞–∞ (–Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏)', work: '–ú–ß–ê–≠–¥–µ 10 –¥—É–≥–∞–∞—Ä', certificate: '–†–≠‚Ññ101228, –∑–∞–ø–∏—Å—å ‚Ññ65 18.09.1945' } });
        addPerson('p3_2', { name: '–ß–æ–æ–¥—É –ú–∞–Ω—á–∞–ª–º–∞–∞', generation: 3, gender: '–∂–µ–Ω', info: { role: '–†–æ–¥–Ω–∞—è —Å–µ—Å—Ç—Ä–∞ –æ—Ç—Ü–∞', full: '–ß–æ–æ–¥—É –ú–∞–Ω—á–∞–ª–º–∞–∞', birth: '10 —Å–µ–Ω—Ç—è–±—Ä—è 1918', parents: '–û—Ç–µ—Ü: –ß–æ–æ–¥—É –ù–∞—á—ã–Ω –ß–∏–≥–∂–∏—Ç, –º–∞—Ç—å: –ß–æ–æ–¥—É –î–æ–ø–ø—É—É –•–∞–º –ß–∞–ª–∞“£', certificate: '–†–≠ ‚Ññ 101257, 18.09.1945', residence: '“Æ-–®—ã–Ω–∞–∞, –∞—Ä–±–∞–Ω ‚Ññ2' } });
        addPerson('p3_3', { name: '–ú–æ–Ω–≥–∞–ª –ú–∞–π–¥—ã—Ä', generation: 3, gender: '–º—É–∂', info: { role: '–ú—É–∂ –ú–∞–Ω—á–∞–ª–º–∞–∞', full: '–ú–æ–Ω–≥–∞–ª –ú–∞–π–¥—ã—Ä', birth: '12 —Ñ–µ–≤—Ä–∞–ª—è 1916', parents: '–û—Ç–µ—Ü: –ß–æ–æ–¥—É –ß–∞–ø—á—ã–π-–æ–æ–ª –°–æ–ª–∞–∞–Ω, –º–∞—Ç—å: –ß–æ–æ–¥—É –ß–∏–∂–æ–π –ù–æ—Ä–¥—É–ø–ø–∞–π', certificate: '–†–≠ ‚Ññ101258', work: '"–û–Ω –¥—É–≥–∞–∞—Ä" –ú–ß–ê–≠–¥–µ' } });
        addPerson('p3_4', { name: '–ù–∞—á—ã–Ω –°–∞“£–¥–∞–ª', generation: 3, gender: '–º—É–∂', info: { role: '–ú–ª–∞–¥—à–∏–π –±—Ä–∞—Ç –æ—Ç—Ü–∞', full: '–ù–∞—á—ã–Ω –°–∞“£–¥–∞–ª', birth: '15 —Ñ–µ–≤—Ä–∞–ª—è 1924', parents: '–û—Ç–µ—Ü: –ù–∞—á—ã–Ω –ù–∞—á—ã–Ω –ß–∏–≥–∂–∏—Ç, –º–∞—Ç—å: –ù–∞—á—ã–Ω –î–æ–ø—É—É –Ø–∞—Ä', certificate: '–†–≠ 101172, –∑–∞–ø–∏—Å—å ‚Ññ124 19.09.1945', work: '–ú–ß–ê–≠–¥–µ 10 –¥—É–≥–∞–∞—Ä' } });
        addPerson('p3_5', { name: '–î”©–º“Ø—Ä-–æ–æ–ª –°–∞“£–º–∞–∞', generation: 3, gender: '–∂–µ–Ω', info: { role: '–°–µ—Å—Ç—Ä–∞ –æ—Ç—Ü–∞', full: '–î”©–º“Ø—Ä-–æ–æ–ª –°–∞“£–º–∞–∞', birth: '31 –∞–≤–≥—É—Å—Ç–∞ 1931', parents: '–û—Ç–µ—Ü: –î”©–º“Ø—Ä-–æ–æ–ª –ë–∞—Ä–∑–∞ ”®—Ä—Ç—ç—ç, –º–∞—Ç—å: –î”©–º“Ø—Ä-–æ–æ–ª –°“Ø—Ä–∂–∏–∏ –Ø–∞—Ä', certificate: '–†–≠ ‚Ññ111808, 22.09.1945', work: '—Ö—É—É –∞–∂—ã–ª–¥—ã–≥' } });
        addPerson('p3_6', { name: '–¢—ã–≤–∞–∞ –¢–æ—Ä–∂—É', generation: 3, gender: '–º—É–∂', info: { role: '–ú–ª–∞–¥—à–∏–π –±—Ä–∞—Ç –æ—Ç—Ü–∞ (–æ—Ç–¥–∞–Ω –Ω–∞ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏–µ)', full: '–¢—ã–≤–∞–∞ –¢–æ—Ä–∂—É', birth: '1 –º–∞—è 1930', parents: '–û—Ç–µ—Ü: –ß–æ–¥—É –ù–∞—á–∏–Ω –ß–∏–∫–∂–∏—Ç, –º–∞—Ç—å: –ß–æ–¥—É –¢–æ–ø—É –Ø—Ä', certificate: '–†–≠ ‚Ññ138002, –∑–∞–ø–∏—Å—å ‚Ññ400 14.01.1946', residence: '“Æ-–®—ã–Ω–∞–∞, –∞—Ä–±–∞–Ω 2' } });
        addPerson('p3_7', { name: '–ù–∞—á—ã–Ω –ß–∞–≥–∞—Ä–º–∞–∞', generation: 3, gender: '–∂–µ–Ω', info: { role: '–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞ –æ—Ç—Ü–∞', full: '–ù–∞—á—ã–Ω –ß–∞–≥–∞—Ä–º–∞–∞', birth: '23 –∞–≤–≥—É—Å—Ç–∞ 1936', parents: '–û—Ç–µ—Ü: –ù–∞—á—ã–Ω –ú”©“£–∫–µ –ß–∏–≥–∂–∏—Ç, –º–∞—Ç—å: –ù–∞—á—ã–Ω –î–æ–∑—É–º –Ø–∞—Ä', certificate: '–†–≠ ‚Ññ101139, –∑–∞–ø–∏—Å—å 145 20.09.1945', work: '–ú–ß–ê–≠ 10 –¥—É–≥–∞–∞—Ä' } });
        // –µ—â–µ –¥–µ—Ç–∏ (–°–∞–º–¥–∞–Ω, –®–∏–ª–∏–º–∞–∞, –°—É–ª–¥—É–º) –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –∑–∞–≥–ª—É—à–∫–∏
        addPerson('p3_8', { name: '–°–∞–º–¥–∞–Ω (–±—Ä–∞—Ç –æ—Ç—Ü–∞)', generation: 3, gender: '–º—É–∂', info: { role: '–°—Ç–∞—Ä—à–∏–π –±—Ä–∞—Ç –æ—Ç—Ü–∞', details: '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É—Ç–æ—á–Ω—è–µ—Ç—Å—è, –º–µ—Å—Ç–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–æ' } });
        addPerson('p3_9', { name: '–®–∏–ª–∏–º–∞–∞ (—Å–µ—Å—Ç—Ä–∞ –æ—Ç—Ü–∞)', generation: 3, gender: '–∂–µ–Ω', info: { role: '–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞ –æ—Ç—Ü–∞', details: '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–∑–∂–µ' } });
        addPerson('p3_10', { name: '–°—É–ª–¥—É–º (–±—Ä–∞—Ç –æ—Ç—Ü–∞)', generation: 3, gender: '–º—É–∂', info: { role: '–ë—Ä–∞—Ç –æ—Ç—Ü–∞', details: '–±—É–¥–µ—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω–æ' } });

        // --- –ü–æ–∫–æ–ª–µ–Ω–∏–µ 4: –¥–µ—Ç–∏ –±—Ä–∞—Ç—å–µ–≤ –∏ —Å–µ—Å—Ç–µ—Ä –æ—Ç—Ü–∞ (–ø–ª–µ–º—è–Ω–Ω–∏–∫–∏) ---
        addPerson('p4_1', { name: '–ú–æ–Ω–≥–∞–ª –ú”©–Ω–≥–µ', generation: 4, gender: '–º—É–∂', info: { role: '–°—ã–Ω –ú–∞–Ω—á–∞–ª–º–∞–∞', full: '–ú–æ–Ω–≥–∞–ª –ú”©–Ω–≥–µ', birth: '30.04.1937', parents: '–û—Ç–µ—Ü: –ú–æ–Ω–≥–∞–ª –ú–∞–π–¥—ã—Ä, –º–∞—Ç—å: –ú–æ–Ω–≥–∞–ª –ú–∞–Ω—á–∞–ª–º–∞–∞', certificate: '–†–≠ ‚Ññ101251, –∑–∞–ø–∏—Å—å 23, —Å—Ç—Ä.122, 18.09.1945' } });
        addPerson('p4_2', { name: '–ú–æ–Ω–≥–∞–ª –ï–ª–∏–∑–∞–≤–µ—Ç–∞ (–õ–∏—Ü–∞)', generation: 4, gender: '–∂–µ–Ω', info: { role: '–î–æ—á—å –ú–∞–Ω—á–∞–ª–º–∞–∞', full: '–ú–æ–Ω–≥–∞–ª –ï–ª–∏–∑–∞–≤–µ—Ç–∞', birth: '30.04.1941', parents: '–û—Ç–µ—Ü –ú–æ–Ω–≥–∞–ª –ú–∞–π–¥—ã—Ä, –º–∞—Ç—å –ú–æ–Ω–≥–∞–ª –ú–∞–Ω—á–∞–ª–º–∞–∞', certificate: '–†–≠ ‚Ññ101252, –ø–æ–≤—Ç–æ—Ä–Ω–æ –©–ò ‚Ññ030383', residence: '“Æ-–®—ã–Ω–∞–∞, –∞—Ä–±–∞–Ω ‚Ññ2' } });
        addPerson('p4_3', { name: '–ú–æ–Ω–≥–∞–ª –î–∏–∏–∑–µ–Ω–º–∞–∞', generation: 4, gender: '–∂–µ–Ω', info: { role: '–î–æ—á—å –ú–∞–Ω—á–∞–ª–º–∞–∞', full: '–ú–æ–Ω–≥–∞–ª –î–∏–∏–∑–µ–Ω–º–∞–∞', birth: '08.08.1944', parents: '–ú–æ–Ω–≥–∞–ª –ú–∞–π–¥—ã—Ä, –ú–æ–Ω–≥–∞–ª –ú–∞–Ω—á–∞–ª–º–∞–∞', birthplace: '“Æ-–®—ã–Ω–∞–∞' } });

        // --- –ü–æ–∫–æ–ª–µ–Ω–∏–µ 5: –¥–µ—Ç–∏ –¥–µ—Ç–µ–π (–¥–µ—Ç–∏ –ï–ª–∏–∑–∞–≤–µ—Ç—ã –∏ –¥—Ä.) ---
        addPerson('p5_1', { name: '–ö—É–Ω–∑–µ–∫ –í–ª–∞–¥–∏–º–∏—Ä –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', generation: 5, gender: '–º—É–∂', info: { role: '–°—ã–Ω –ï–ª–∏–∑–∞–≤–µ—Ç—ã', full: '–ö—É–Ω–∑–µ–∫ –í–ª–∞–¥–∏–º–∏—Ä –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', birth: '1965' } });
        addPerson('p5_2', { name: '–ö—É–Ω–∑–µ–∫ –í–∞–¥–∏–º –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', generation: 5, gender: '–º—É–∂', info: { role: '–°—ã–Ω –ï–ª–∏–∑–∞–≤–µ—Ç—ã', full: '–ö—É–Ω–∑–µ–∫ –í–∞–¥–∏–º –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', birth: '1967', spouse: '–∂–µ–Ω–∞ –ó–∞—Ä–∏–Ω–∞ –ú–∞–∞–¥—ã—Ä–æ–≤–Ω–∞' } });
        addPerson('p5_3', { name: '–°–∞–Ω–¥—ã–π-–æ–æ–ª –ê–π–Ω–∞—à –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞', generation: 5, gender: '–∂–µ–Ω', info: { role: '–î–æ—á—å –ï–ª–∏–∑–∞–≤–µ—Ç—ã', full: '–°–∞–Ω–¥—ã–π-–æ–æ–ª –ê–π–Ω–∞—à –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞', birth: '1971', spouse: '–º—É–∂ –°–∞–Ω–¥—ã–π-–æ–æ–ª –ê–Ω–¥—Ä–µ–π –ê–Ω–∞—Ç–æ–ª—å–µ–≤–∏—á' } });
        addPerson('p5_4', { name: '–ö—É–Ω–∑–µ–∫ –ê—è—Å –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', generation: 5, gender: '–º—É–∂', info: { role: '–°—ã–Ω –ï–ª–∏–∑–∞–≤–µ—Ç—ã', full: '–ö—É–Ω–∑–µ–∫ –ê—è—Å –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', birth: '1973' } });
        addPerson('p5_5', { name: '–ö—É–Ω–∑–µ–∫ –ë–∞–π—ã—Ä-–ë–µ–ª–µ–∫ –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', generation: 5, gender: '–º—É–∂', info: { role: '–°—ã–Ω –í–∞–¥–∏–º–∞', full: '–ö—É–Ω–∑–µ–∫ –ë–∞–π—ã—Ä-–ë–µ–ª–µ–∫', birth: '1990' } });
        addPerson('p5_6', { name: '–ß—É–¥–∞–∫ –î–∞—è–Ω–∞ –í–∞–¥–∏–º–æ–≤–Ω–∞', generation: 5, gender: '–∂–µ–Ω', info: { role: '–î–æ—á—å –í–∞–¥–∏–º–∞', full: '–ß—É–¥–∞–∫ –î–∞—è–Ω–∞ –í–∞–¥–∏–º–æ–≤–Ω–∞', birth: '1998' } });
        addPerson('p5_7', { name: '–°–∞–Ω–¥—ã–π-–æ–æ–ª –ò—Ä–∏–Ω–∞ –ê–Ω–¥—Ä–µ–µ–≤–Ω–∞', generation: 5, gender: '–∂–µ–Ω', info: { role: '–î–æ—á—å –ê–π–Ω–∞—à', birth: '1996' } });
        addPerson('p5_8', { name: '–°–∞–Ω–¥—ã–π-–æ–æ–ª –ò–≥–æ—Ä—å –ê–Ω–¥—Ä–µ–µ–≤–∏—á', generation: 5, gender: '–º—É–∂', info: { role: '–°—ã–Ω –ê–π–Ω–∞—à', birth: '2004' } });

        // --- –†–û–î–ù–Ø –ü–û –ú–ê–¢–ï–†–ò (–∫—Ä–∞—Ç–∫–æ, –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—É–ø–µ–Ω–∏) ---
        // 1 –ø–æ–∫–æ–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–æ–π –ª–∏–Ω–∏–∏ (–ø—Ä–∞–¥–µ–¥—ã)
        addPerson('m1_1', { name: '–ß–æ–æ–¥—É –î–æ–ª–∑–∞—Ç –ß–∞–º—ã—è–Ω', generation: 101, info: { role: '–ú–∞—Ç—å –æ—Ç—Ü–∞ –º–æ–µ–π –º–∞—Ç–µ—Ä–∏', line: ' maternal' } }); 
        addPerson('m1_2', { name: '–ß–æ–æ–¥—É –î–∞–Ω–∑—ã–Ω –ß–∏–≥–∂–∏—Ç', generation: 101, info: { role: '–û—Ç–µ—Ü –æ—Ç—Ü–∞ –º–æ–µ–π –º–∞—Ç–µ—Ä–∏', line: 'maternal' } });
        // 2 –ø–æ–∫–æ–ª–µ–Ω–∏–µ (–¥–µ–¥—É—à–∫–∞ –∏ –±–∞–±—É—à–∫–∞ –º–∞—Ç–µ—Ä–∏)
        addPerson('m2_1', { name: '–ß–æ–æ–¥—É –ê–∂—ã–∫–∫–∞–π –£–∑—É–Ω –∞—à–∞–∫ —É—Ä—É—É', generation: 102, info: { role: '–ú–∞—Ç—å –º–æ–µ–π –º–∞—Ç–µ—Ä–∏', full: '–ê–∂—ã–∫–∫–∞–π', birth: '–æ–∫. 1888', details: '“Æ-–®—ã–Ω–∞–∞, –Ω–∞ 1945 ‚Äì 57 –ª–µ—Ç' } });
        addPerson('m2_2', { name: '–ß–æ–æ–¥—É –î–µ–º—á–∏–∫–∫–µ–π –î–∞–Ω–∑—ã–Ω (–¢–µ–º—á–∏–∫–µ–π –ß–∞–≤–∞–∞)', generation: 102, info: { role: '–û—Ç–µ—Ü –º–æ–µ–π –º–∞—Ç–µ—Ä–∏', full: '–ß–æ–æ–¥—É –î–µ–º—á–∏–∫–∫–µ–π –î–∞–Ω–∑—ã–Ω', birth: '15.09.1889', work: '–º–∞–ª, —Ç–∞—Ä–∞–∞ –∞–∂—ã–ª—ã, –ú–ß–ê–≠ –∫–µ–∂–∏–≥“Ø“Ø–Ω“Ø' } });
        // 3 –ø–æ–∫–æ–ª–µ–Ω–∏–µ: –º–∞—Ç—å –∏ –µ—ë –±—Ä–∞—Ç—å—è/—Å–µ—Å—Ç—Ä—ã
        addPerson('m3_1', { name: '–°–∞–Ω—á–∞—Ç –û–∫–∞—à—Ç–∞–π –î–µ–º—á–∏–∫–µ–π–æ–≤–Ω–∞ (–ß–æ–æ–¥—É –û–∫–∫–∞—à—Ç–∞–π)', generation: 103, info: { role: '–ú–æ—è –º–∞—Ç—å', full: '–°–∞–Ω—á–∞—Ç –û–∫–∞—à—Ç–∞–π', birth: '01.03.1920 “Æ-–®—ã–Ω–∞–∞', maiden: '–ß–æ–æ–¥—É –û–∫–∫–∞—à—Ç–∞–π –î–µ–º—á–∏–∫–∫–µ–π' } });
        addPerson('m3_2', { name: '–°–∞–∞–¥–∞–∫ –ê—Å—Ç—ã—Ä', generation: 103, info: { role: '–°—Ç–∞—Ä—à–∏–π –±—Ä–∞—Ç –º–∞—Ç–µ—Ä–∏', birth: '05.07.1904', parents: '–ß–æ–æ–¥—É –î”©–º“Ø—Ä-–æ–æ–ª ”®—Ä—à—ç—ç, –ß–æ–æ–¥—É –ê–∂—ã–∫–∫–∞–π –¢—ã–≤–∞–∞–Ω (—É–º–µ—Ä–ª–∞)' } });
        addPerson('m3_3', { name: '–ê–π—ã—ã—Ä –î“Ø—à–±“Ø–Ω', generation: 103, info: { role: '–°—Ç–∞—Ä—à–∏–π –±—Ä–∞—Ç –º–∞—Ç–µ—Ä–∏ (–≤–æ—Å–ø–∏—Ç–∞–Ω–Ω–∏–∫)', birth: '01.09.1909', parents: '–®–∞–ª—ã–∫ –ê–π—ã—ã—Ä –ë–∞—Ä–∑—ã“£–∞–π, –®–∞–ª—ã–∫ –¢—ã—ã–¥—ã–π –ß–∞–º—ã–π–∞–Ω' } });
        addPerson('m3_4', { name: '–î–∞–ø—ã–π-–æ–æ–ª –ù–∏–∫–æ–ª–∞–π', generation: 103, info: { role: '–°—Ç–∞—Ä—à–∏–π –±—Ä–∞—Ç –º–∞—Ç–µ—Ä–∏', birth: '10.04.1915', party: '–ø–∞—Ä—Ç–±–∏–ª–µ—Ç ‚Ññ7900107, —Å–≤-–≤–æ –†–≠ ‚Ññ111033' } });
        addPerson('m3_5', { name: '–ß–æ–æ–¥—É –î—É“£–º–∞–π', generation: 103, info: { role: '–°—Ç–∞—Ä—à–∞—è —Å–µ—Å—Ç—Ä–∞ –º–∞—Ç–µ—Ä–∏', birth: '15.03.1917' } });
        addPerson('m3_6', { name: '–î–∏–∏–º–∞–∞ –ß–æ–æ–¥—É', generation: 103, info: { role: '–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞ –º–∞—Ç–µ—Ä–∏', birth: '08.03.1922', certificate: '–†–≠ ‚Ññ111195, –∫–æ–º—Å–æ–º–æ–ª—å—Å–∫–∏–π –±–∏–ª–µ—Ç', parents: '–ß–æ–æ–¥—É –¢—É–∫—Ç—É–≥ –¢–µ–º—á–∏–∫–µ–π, –ß–æ–æ–¥—É –ö–∞–ª—á–∞–Ω –ù–æ–≥–∞–∞–Ω' } });
        addPerson('m3_7', { name: '–•—É—É—Ä–∞–∫-–æ–æ–ª –ß–æ–æ–¥—É', generation: 103, info: { role: '–ú–ª–∞–¥—à–∏–π –±—Ä–∞—Ç –º–∞—Ç–µ—Ä–∏', birth: '15.01.1923', parents: '–¢–µ–º—á–∏–∫–µ–π –ß–∞–≤–∞–∞ –î–∞–Ω–∑—ã–Ω, –¢–µ–º—á–∏–∫–µ–π –ê–∂—ã–∫–∫–∞–π –£–∑—É–Ω', certificate: '–†–≠ ‚Ññ101140' } });
        addPerson('m3_8', { name: '–ß–∞–∂—ã–ª–º–∞–∞ –ï–ª–∏–∑–∞–≤–µ—Ç–∞ (–î–µ–º—á–∏–∫–µ–π –ß–∞–∂–∞–ª–º–∞–∞)', generation: 103, info: { role: '–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞ –º–∞—Ç–µ—Ä–∏', birth: '03.07.1929 / 15.08.1929', double: '–¥–≤–∞ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞', certificate1: '–†–≠ ‚Ññ111041', certificate2: '–†–≠ ‚Ññ101180' } });
        addPerson('m3_9', { name: '–î–µ–º—á–∏–∫–∫–µ–π –û–Ω–µ—Ä–º–∞–∞', generation: 103, info: { role: '–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞ –º–∞—Ç–µ—Ä–∏', birth: '01.01.1936', parents: '–î–µ–º—á–∏–∫–∫–µ–π –ß–∞–≤–∞–∞ –î–∞–Ω–∑—ã–Ω, –ß–æ–æ–¥—É –ö—É—Å–∫–µ–ª–¥–µ–π –°—É—Ä—É–Ω', certificate: '–†–≠ ‚Ññ101078' } });
        // 4 –ø–æ–∫–æ–ª–µ–Ω–∏–µ ‚Äî —è –∏ —Å–∏–±–ª–∏–Ω–≥–∏ (–¥–µ—Ç–∏ –º–∞—Ç–µ—Ä–∏ –∏ –æ—Ç—Ü–∞)
        addPerson('p4_self_1', { name: '–°–∞–Ω—á–∞—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á (—è)', generation: 104, info: { role: '–Ø', full: '–°–∞–Ω—á–∞—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', birth: '06.06.1959 –°–∞–º–∞–≥–∞–ª—Ç–∞–π', education: '–í—ã—Å—à–µ–µ –ö–§–ö–ü–ò, –†–ê–ì–°', work: '–ì–æ—Å. —Å–ª—É–∂–∞—â–∏–π, –∏–Ω–∂–µ–Ω–µ—Ä-—Å—Ç—Ä–æ–∏—Ç–µ–ª—å' } });
        addPerson('p4_self_2', { name: '–°–∞–Ω—á–∞—Ç –í–∏–∫—Ç–æ—Ä –ù–∞—á—ã–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '22.08.1939', work: '–ª–µ—Å–Ω–∏–∫' } });
        addPerson('p4_self_3', { name: '–°–∞–Ω—á–∞—Ç-–æ–æ–ª –°—É–∫—Ç–∞—Ä-–æ–æ–ª –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '14.09.1944', work: '–º–µ—Ö–∞–Ω–∏–∫ –ª–µ—Å—Ö–æ–∑–∞' } });
        addPerson('p4_self_4', { name: '–°–∞–Ω—á–∞—Ç –ë–æ–ª–∞—Ç-–æ–æ–ª –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '25.05.1947', work: '—à–æ—Ñ–µ—Ä —Ä–∞–π–ø–æ' } });
        addPerson('p4_self_5', { name: '–°–∞–Ω—á–∞—Ç –ö–∞–Ω-–æ–æ–ª –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '19.10.1949', work: '–ª–µ—Å–Ω–∏–∫' } });
        addPerson('p4_self_6', { name: '–°–∞–Ω—á–∞—Ç (–ë–∞–π—ã—Ä-–æ–æ–ª) –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –°–∞–Ω–¥–∞–Ω–æ–≤–Ω–∞', generation: 104, info: { role: '–°–µ—Å—Ç—Ä–∞', birth: '25.08.1951', work: '–±—É—Ö–≥–∞–ª—Ç–µ—Ä' } });
        addPerson('p4_self_7', { name: '–°–∞–Ω—á–∞—Ç –ë–æ—Ä–∏—Å –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '05.10.1953', work: '—Ä–∞–±–æ—á–∏–π' } });
        addPerson('p4_self_8', { name: '–°–∞–Ω—á–∞—Ç –í–ª–∞–¥–∏–º–∏—Ä –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '12.02.1956', work: '–º–∞—Å—Ç–µ—Ä —Ä–∞–π–≥–∞–∑–∞' } });
        addPerson('p4_self_9', { name: '–°–∞–Ω—á–∞—Ç –ê–ª–µ–∫—Å–µ–π –°–∞–Ω–¥–∞–Ω–æ–≤–∏—á', generation: 104, info: { role: '–ë—Ä–∞—Ç', birth: '05.07.1961', work: '–∑–∞–≤—É—á —Å–ø–æ—Ä—Ç—à–∫–æ–ª—ã' } });
        addPerson('p4_self_10', { name: '–°–∞–Ω—á–∞—Ç –û–ª—å–≥–∞ –°–∞–Ω–¥–∞–Ω–æ–≤–Ω–∞', generation: 104, info: { role: '–°–µ—Å—Ç—Ä–∞', birth: '25.08.1963', work: '–ø—Ä–æ–¥–∞–≤–µ—Ü' } });

        // —É–∫–∞–∂–µ–º —Å—É–ø—Ä—É–∂–µ—Å—Ç–≤–æ –æ—Ç—Ü–∞ –∏ –º–∞—Ç–µ—Ä–∏ –¥–ª—è —Å–≤—è–∑–∏
        // –¥–ª—è —Ü–µ–ª–µ–π –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–∏–º —Ç–∞–∫–∂–µ –∫–∞—Ä—Ç–æ—á–∫—É –º–∞—Ç–µ—Ä–∏ –∫–∞–∫ —Å—É–ø—Ä—É–≥–∏ –æ—Ç—Ü–∞ (–æ–Ω–∞ —É–∂–µ –µ—Å—Ç—å m3_1)

        // —Ñ—É–Ω–∫—Ü–∏—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è–º (–∏—Å–ø–æ–ª—å–∑—É–µ–º —á–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ generation, —É maternal 101,102,103,104)
        const byGeneration = {};
        Object.values(persons).forEach(p => {
            const g = p.generation;
            if (!byGeneration[g]) byGeneration[g] = [];
            byGeneration[g].push(p);
        });

        // —Å–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª—é—á–∏ –ø–æ–∫–æ–ª–µ–Ω–∏–π
        const sortedGens = Object.keys(byGeneration).map(Number).sort((a,b) => a - b);

        // —Å—Ç—Ä–æ–∏–º DOM –¥–µ—Ä–µ–≤–∞
        const nodesLayer = document.getElementById('nodesLayer');
        nodesLayer.innerHTML = '';
        const rowMap = {}; // –∑–∞–ø–æ–º–Ω–∏–º —Ä—è–¥—ã

        sortedGens.forEach(gen => {
            const row = document.createElement('div');
            row.className = 'generation-row';
            row.dataset.gen = gen;
            const label = document.createElement('div');
            label.className = 'gen-label';
            if (gen === 1) label.innerText = '‚Ö† –ü–æ–∫–æ–ª–µ–Ω–∏–µ –ø—Ä–∞—Ä–æ–¥–∏—Ç–µ–ª–µ–π';
            else if (gen === 2) label.innerText = '‚Ö° –ü–æ–∫–æ–ª–µ–Ω–∏–µ –±–∞–±—É—à–µ–∫ –∏ –¥–µ–¥—É—à–µ–∫ (—Ä–æ–¥–∏—Ç–µ–ª–∏ –æ—Ç—Ü–∞)';
            else if (gen === 3) label.innerText = '‚Ö¢ –ü–æ–∫–æ–ª–µ–Ω–∏–µ ‚Äî –æ—Ç–µ—Ü, –µ–≥–æ –±—Ä–∞—Ç—å—è –∏ —Å—ë—Å—Ç—Ä—ã';
            else if (gen === 4) label.innerText = '‚Ö£ –ü–æ–∫–æ–ª–µ–Ω–∏–µ ‚Äî –¥–µ—Ç–∏ –±—Ä–∞—Ç—å–µ–≤ –∏ —Å–µ—Å—Ç—ë—Ä –æ—Ç—Ü–∞ / –ø–ª–µ–º—è–Ω–Ω–∏–∫–∏';
            else if (gen === 5) label.innerText = '‚Ö§ –ü–æ–∫–æ–ª–µ–Ω–∏–µ ‚Äî –¥–µ—Ç–∏ –¥–µ—Ç–µ–π (–≤–Ω—É–∫–∏ –ø–ª–µ–º—è–Ω–Ω–∏–∫–æ–≤)';
            else if (gen === 101) label.innerText = '‚Ö† (–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ª–∏–Ω–∏—è) –ü—Ä–∞–¥–µ–¥—ã –º–∞—Ç–µ—Ä–∏';
            else if (gen === 102) label.innerText = '‚Ö° (–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ª–∏–Ω–∏—è) –ë–∞–±—É—à–∫–∞ –∏ –¥–µ–¥—É—à–∫–∞ –º–∞—Ç–µ—Ä–∏';
            else if (gen === 103) label.innerText = '‚Ö¢ (–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ª–∏–Ω–∏—è) –ú–∞—Ç—å, –µ—ë –±—Ä–∞—Ç—å—è –∏ —Å—ë—Å—Ç—Ä—ã';
            else if (gen === 104) label.innerText = '‚Ö£ (–Ø –∏ –º–æ–∏ –±—Ä–∞—Ç—å—è –∏ —Å—ë—Å—Ç—Ä—ã)';
            else label.innerText = `–ü–æ–∫–æ–ª–µ–Ω–∏–µ ${gen}`;
            row.appendChild(label);

            byGeneration[gen].forEach(person => {
                const card = document.createElement('div');
                card.className = 'person-node';
                card.dataset.id = person.id;
                const nameDiv = document.createElement('div');
                nameDiv.className = 'person-name';
                nameDiv.innerText = person.name.length > 30 ? person.name.slice(0,28)+'‚Ä¶' : person.name;
                const detailDiv = document.createElement('div');
                detailDiv.className = 'person-details';
                let infoPiece = '';
                if (person.info.birth) infoPiece = 'üìÖ ' + person.info.birth;
                else if (person.info.role) infoPiece = person.info.role;
                detailDiv.innerText = infoPiece;
                const photoDiv = document.createElement('div');
                photoDiv.className = 'person-photo-placeholder';
                card.appendChild(nameDiv);
                card.appendChild(detailDiv);
                card.appendChild(photoDiv);

                card.addEventListener('click', (e) => {
                    document.querySelectorAll('.person-node').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    showPersonInfo(person.id);
                });
                row.appendChild(card);
            });
            nodesLayer.appendChild(row);
            rowMap[gen] = row;
        });

        // –ª–∏–Ω–∏–∏ —Ä–æ–¥—Å—Ç–≤–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ –¥–æ–±–∞–≤–∏–º —á—É—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ observe, –Ω–æ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–º—Å—è)
        // —Ñ—É–Ω–∫—Ü–∏—è info
        window.showPersonInfo = function(id) {
            const p = persons[id];
            if (!p) return;
            const info = p.info || {};
            const c = document.getElementById('infoContent');
            let html = `<div class="info-field"><strong>${p.name}</strong></div>`;
            html += `<div class="info-field"><strong>–†–æ–ª—å</strong> ${info.role || '‚Äî'}</div>`;
            if (info.full) html += `<div class="info-field"><strong>–ü–æ–ª–Ω–æ–µ –∏–º—è</strong> ${info.full}</div>`;
            if (info.birth) html += `<div class="info-field"><strong>–î–∞—Ç–∞/–º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è</strong> ${info.birth}</div>`;
            if (info.parents) html += `<div class="info-field"><strong>–†–æ–¥–∏—Ç–µ–ª–∏</strong> ${info.parents}</div>`;
            if (info.certificate) html += `<div class="info-field"><strong>–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ</strong> ${info.certificate}</div>`;
            if (info.residence) html += `<div class="info-field"><strong>–ú–µ—Å—Ç–æ –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞</strong> ${info.residence}</div>`;
            if (info.work) html += `<div class="info-field"><strong>–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong> ${info.work}</div>`;
            if (info.details) html += `<div class="info-field"><strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</strong> ${info.details}</div>`;
            if (info.spouse) html += `<div class="info-field"><strong>–°—É–ø—Ä—É–≥(–∞)</strong> ${info.spouse}</div>`;

            html += `<div class="photo-upload">
                        <label for="photoInput">üì∑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</label>
                        <input type="file" id="photoInput" accept="image/*" style="display:none" onchange="previewPhoto(event)">
                        <div id="photo-preview"></div>
                    </div>`;
            c.innerHTML = html;
            window.currentPhotoPerson = id;
        };

        window.previewPhoto = function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewDiv = document.getElementById('photo-preview');
                    previewDiv.innerHTML = `<img src="${e.target.result}" id="person-photo-img" alt="—Ñ–æ—Ç–æ">`;
                };
                reader.readAsDataURL(file);
            }
        };

        // –≤—ã–¥–µ–ª–∏–º —Å–µ–±—è
        setTimeout(() => {
            const myCard = document.querySelector('[data-id="p4_self_1"]');
            if (myCard) myCard.click();
        }, 300);
    })();
</script>

<!-- –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–µ–ª–∫–∞—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è –ª–∏–Ω–∏–π, –Ω–æ –≤ —ç—Ç–æ–º –∫–æ–¥–µ –ª–∏–Ω–∏–∏ –±—É–¥—É—Ç –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω—ã –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –æ—Ç–¥–µ–ª—å–Ω–æ. –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –æ–≥—Ä–∞–Ω–∏—á–∏–º—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π -->
</body>
</html>
